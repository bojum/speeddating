## Question: do people with excess self-esteem get more romantic interest?

```{r, echo = FALSE}

load("data/speed_dating.RData")

## keep only variables of interest
confidence <- speed_dating %>% select(iid, gender, pid, dec_o,
                                      samerace,
                                      attr3_1:amb3_1, attr3_2:amb3_2,
                                      attr_o:amb_o)

## get self-rate scores (before the event)
self_eval <- confidence %>% select(iid, attr3_1:amb3_1) %>% 
  group_by(iid) %>% 
  summarise_at(vars(attr3_1:amb3_1), mean, na.rm = TRUE) %>%
  gather(key = attr, value = self_score, -iid) %>% 
  filter(!is.na(self_score)) %>%
  mutate(attr = gsub("3_1", "", attr))

## get self-rate scores (after the event)
self_eval_after <- confidence %>% select(iid, attr3_2:amb3_2) %>% 
  group_by(iid) %>% 
  summarise_at(vars(attr3_2:amb3_2), mean, na.rm = TRUE) %>%
  gather(key = attr, value = self_score_after, -iid) %>% 
  filter(!is.na(self_score_after)) %>%
  mutate(attr = gsub("3_2", "", attr))

## get averaged peer-rate scores
peer_eval <- confidence %>% select(iid, attr_o:amb_o) %>% 
  group_by(iid) %>% 
  summarise_at(vars(attr_o:amb_o), mean, na.rm = TRUE) %>%
  gather(key = attr, value = peer_score, -iid) %>% 
  filter(!is.na(peer_score)) %>%
  mutate(attr = gsub("_o", "", attr))

## get the number of likes for each subject
sublect_match <- confidence %>% group_by(iid) %>% 
  summarize(picked = sum(dec_o), total = n()) %>%
  mutate(proportion = picked/total)

## join all three dataframes and compute %like
eval_df <- self_eval %>% inner_join(peer_eval, by = c("iid"="iid", "attr"="attr")) %>%
  inner_join(self_eval_after, by = c("iid"="iid", "attr"="attr")) %>%
  group_by(iid, attr) %>%
  summarise_all(mean) %>% 
  mutate(diff_before = self_score - peer_score) %>%
  left_join(sublect_match, by = "iid") %>%
  left_join(confidence %>% select(iid, gender), by="iid") %>%
  ungroup()

temp <- speed_dating %>% 
  select(iid, race, from, field_cd, sports:yoga) %>% 
  unique()

diff_df <- eval_df %>% 
  select(iid, gender, attr, diff_before, proportion, self_score, peer_score) %>% 
  mutate(gender = as.factor(gender)) %>%
  unique() %>% 
  left_join(temp, by ="iid") %>% 
  mutate(field_cd = as.factor(field_cd),
         race = as.factor(race)) %>% 
  unique
```

Self-enhancement is one kind of motivation that makes people feel good and boost their confidence (https://en.wikipedia.org/wiki/Self-enhancement). Epley and Whitchurch's work is one evidence supporting the idea that people tend to see themselves better that the reality (https://journals.sagepub.com/doi/abs/10.1177/0146167208318601?journalCode=pspc). The phenomenon is also known as "illusory superiority", where the majority of people evaluates themself as better than the average.

It is widely believed that confident people preform better in various tasks including in relationships (see [Link](https://www.psychologytoday.com/us/blog/shyness-is-nice/201809/why-self-confidence-is-more-important-you-think)). This section of the analysis focuses on this idea. Specifically, we want to know if *confident people get more interests during the Speed Dating session*.

Given the dataset, we define confidence, or excess self-esteem, as how much higher a subject evaluates itself than other people rate the subject (`peer score`). That is, the varaible excess self-esteem is calculated by subtracting an averaged evaluation score given by others from the score given to self. A large positive difference indicates highly excess self-esteem. A large negative difference suggests very low self-esteem. The variable is called `self-esteem` in the analysis and `peer score` is an average score a subject received from other people.


![http://images.lipy.com/women-vs-men](img/3_self_esteem.jpg)

One distinct characteristics of participants is gender. However, the previous question found no difference between genders. Moreover, this characteristics does not distinquish subjects in terms of their excess self-esteem. Below are distribution of score difference for each gender in each attribute. Their distribution are similar, peaking at around 1 with almost identical spread. 


```{r, figwidth = 12}
attr_list <- c("amb"="Ambitious", "attr"="Attractive", "fun"="Fun", "intel"="Intelligent", "sinc"="Sincere")
ggplot(eval_df %>% mutate(gender = ifelse(gender == 0, "Female", "Male"),
                          gender = as.factor(gender),
                          attr = attr_list[attr]), aes(x=diff_before, fill = gender)) + 
  geom_density(alpha = 0.5) + 
  ggtitle("Histogram of Evaluation Ratio") + 
  xlab("Ratio") + 
  facet_grid(~attr)
```

When `self-esteem` is plotted against the proportion of people who want to meet with a subject again, referred to as `interest proportion`, the only small difference between gender is that female participants tend to get higher interest proportion than male participants. This is shown by more red dots locating at the top and more blue dots at the bottom of the graph. However, dots at the top and the bottom constitute only a small number of participants. Therefore, this analysis treat both genders collectively. 

```{r, fig.width=12}
## color by gender
ggplot(diff_df, aes(x=diff_before, y = proportion, color = gender)) + 
  geom_point(alpha = 0.5) + 
  facet_grid(~attr) + 
  xlab("Self Esteem") + 
  ylab("Interest Proportion")
```

The plots above also suggest that people with excess self-esteem generally have low interest proportion. The correlation is stronger in fun and attractive, with the most negative correlation in attractive. That is, a participant with lower self-esteem in his/her own attractive and fun tend to get more romatic interest from the others. 

```{r}
cor_list <- lapply(eval_df$attr %>% unique(), function(a){
  attr_eval_df <- eval_df%>% ungroup() %>% filter(attr == a) %>% select(diff_before, proportion)
  c <- cor(attr_eval_df$diff_before, attr_eval_df$proportion)
  return(data.frame("Attribute"=a, "Correlation" = c))
})

attr_list <- c("attr"="Attractive", "sinc"="Sincere", "amb"="Ambitious", "fun"="Fun", "intel"="Intelligent")
cor_df <- do.call(rbind, cor_list) %>% mutate(Attribute = attr_list[Attribute])
cor_df %>% kable() %>% kable_styling()
```

The fact that attractive has the strongest correlation with interest proportion should not be surprising since it is the attribute that people look for the most in their partner (discussed in previous question). The next part narrows its focus down to attractive attribute only.

Below is a plot of `peer score` against `interest proportion`. Data points are colored by `self esteem`. Darker color indicates a person with lower self-esteem.

```{r}
ggplot(diff_df %>% filter(attr == "attr") %>%
         rename(self_esteem = diff_before), 
       aes(x=peer_score , y =  proportion, color = self_esteem)) + 
  geom_point() + 
  xlab("Peer Score") + 
  ylab("Interest Proportion")
```

The plot shows a linear relationship between peer evaluation score and interest proportion. A person who, othter people think, is attractive gain more romantic interest proportion, especially when average score is below 5. The linear relationship becomes weaker for those with score larger than 6.

We also found that people who are less confident in their attractiveness tend to get more interests. This is shown by darker dots at the top right of the plot. Poeple with low self esteem gain more proportion of interest.

Before jumping into a conclusion that being attractive is what matters, we inspect other characteristics of subjects. We are curious whether there are some confounding varaibles (other than what has been explored in the previous questions) that get a subject more romantic interest. All the graphs below are relationships between `peer score` on attractive and `interest proportion`. Dots are colored by other characterisitcs that we want to inspect.

#### Race

```{r}
race_list <- c("Black/African American", "European/Caucasian-American", "Latino/Hispanic American",
               "Asian/Pacific Islander/Asian-American", "Native American", "Other")


pl1 <- ggplot(diff_df %>% filter(attr == "attr") %>% 
         select(iid, race) %>% 
         group_by(race) %>%
         summarize(cnt = n()) %>%
         mutate(race = race_list[race]), aes(x = fct_reorder(race, cnt), y = cnt, fill = race)) + 
  geom_col() + coord_flip() + 
  xlab("") + 
  ylab("count")  +
  theme(legend.position = "none")

pl2 <- ggplot(diff_df %>% filter(attr == "attr") %>%
         mutate(race = race_list[race]), 
         aes(x=peer_score, y = proportion, color = race)) + 
  geom_point(alpha = 1) +
  xlab("Peer Score for Attractive") + 
  ylab("Interest Proportion")  

ggplotly(pl1, tooltip = c("cnt"))
ggplotly(pl2, tooltip = c("race"))


#subplot(ggplotly(pl1, tooltip = c("cnt")), ggplotly(pl2, tooltip = c("race")),nrows=1)
```

We find no pattern among `proportion`, `peer_score`, and `race`.

#### Field of Study

```{r}
field_list <- c("Law", "Math", "Social Science", "Psychologist", "Medical Science", "Pharmaceuticals and Bio Tech",
                "Engineering", "English/Creative Writing/ Journalism", "History/Religion/Philosophy",
                "Business/Econ/Finance", "Education, Academia", "Biological Sciences/Chemistry/Physics",
                "Social Work", "Undergrad/undecided", "Political Science/International Affairs", "Film",
                "Fine Arts/Arts Administration", "Languages", "Architecture", "Other")

pl1 <- ggplot(diff_df %>% filter(attr == "attr", !is.na(field_cd)) %>% 
         select(iid, field_cd) %>% 
         group_by(field_cd) %>%
         summarize(cnt = n()) %>%
         mutate(field_cd = field_list[field_cd]), 
         aes(x = fct_reorder(field_cd, cnt), y = cnt, fill = field_cd)) + 
  geom_col() + coord_flip() + 
  xlab("") + 
  ylab("count") +
  theme(legend.position = "none")

## field X
pl2 <- ggplot(diff_df %>% 
                filter(attr == "attr", !is.na(field_cd)) %>%
         mutate(field_cd = field_list[field_cd]), 
         aes(x=peer_score, y = proportion, color = field_cd)) + 
  geom_point(alpha = 1) +
  xlab("Attractive Peer Score") + 
  ylab("Interest Proportion")

ggplotly(pl1, tooltip = c("cnt"))
ggplotly(pl2, tooltip = c("field_cd"))

#subplot(ggplotly(pl1, tooltip = c("cnt")), ggplotly(pl2, tooltip = c("field_cd")), nrows=1)
```


```{r}
fc <- read.csv("data/field_cat.csv") %>% 
  mutate(cd = row_number())
cat_list <- fc$cat %>% as.character()
names(cat_list) <- fc$cd

diff_df <- diff_df %>% mutate(field_cate_cd = cat_list[field_cd]) 
```

In addition to considering individual majors, we create major categories to see any general pattern that involves in school majors. 

```{r}
pl1 <- ggplot(diff_df %>% filter(attr == "attr", !is.na(field_cate_cd)) %>%  
         select(iid, field_cate_cd)%>% 
         group_by(field_cate_cd) %>%
         summarize(cnt = n()), 
         aes(x = fct_reorder(field_cate_cd, cnt), y = cnt, fill = field_cate_cd)) + 
  geom_col() + coord_flip() + 
  xlab("") + 
  ylab("count") +
  theme(legend.position = "none")

pl2 <- ggplot(diff_df %>% filter(attr == "attr", !is.na(field_cate_cd)), 
       aes(x=peer_score, y = proportion, color = field_cate_cd)) + 
  geom_point(alpha = 1) +
  theme(legend.position = "none") + 
  xlab("Attractive Peer Score") + 
  ylab("Interest Proportion")

ggplotly(pl1, tooltip = c("cnt"))
ggplotly(pl2, tooltip = c("field_cate_cd"))

#subplot(ggplotly(pl1, tooltip = c("cnt")), ggplotly(pl2, tooltip = c("field_cate_cd")), nrows=1)
```

There is also no pattern among `proportion`, `peer_score`, and study `field`.

As far as we know, attractiveness is the only characteristic that have the strongest correlation with interest propotion. In conclusion, we found that people with low self esteem in their attractiveness gain more romantic interest after the event. 
