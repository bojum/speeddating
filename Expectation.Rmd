## How Males and Females' Expectation and Self-Evaluation Differ?

From the plot we found that only a small proportion of people participate in the experiment for dating, which meant they may not treat the dating seriously and just choose their partners randomly. So in this section, we explored whether people really chose to date with someone that meet their expectation, or they made their decision basing on other factors, and is there a difference between male and female. Another thing we were interested in is would males and females' self-evaluation be influenced after they dating with someone.


```{r}
load("data/speed_dating.RData")
speed_dating %>% select(iid,goal) %>%
  drop_na() %>% 
  mutate(goal=ifelse(goal==1,"fun",
                     ifelse(goal==2,"making friends",
                            ifelse(goal==3|goal==4,"dating",
                                   ifelse(goal==5,"peer pressure","others"))))) %>%   
  unique() %>% 
  group_by(goal) %>% 
  summarise(frequency=n()) %>% 
  mutate(dating=ifelse(goal=="dating","Yes","No")) %>% 
  ggplot(aes(x=reorder(goal,frequency),y=frequency,fill=dating))+
  geom_bar(stat = "identity")+
  scale_fill_manual(values = c("grey50","lightblue"))+
  labs(x="goal",title = "The Reason People Participate the Experiment")+
  xlab("Goal")+
  ylab("Frequency")+
  theme(legend.position = "none")+theme(axis.text.x = element_text(size = 14), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14))
```

We define expectation as how people weight the importance of some attributes of their partners, and define self-evaluation of how people score their performance on those attributes. In this experiment people were asked their opinions about six attributes, which we descibed in section 2.2, to represent their expectation and five attributes to represent their self-evaluation ("share hobby" is dropped).

### Expectations {-#i}

#### How Does Males and Females' Expectation Change Before and After Datings? {-#i}

In this part, we analyzed the weights of expectation in six attributes (attractive, sincere, intelligent, fun, ambitious and shared hobbies) between males and females, and how did the weight change after meeting someone.

```{r}
gender_exp <- speed_dating %>% 
  select(iid,gender
         ,attr1_1:shar1_1                        # exp weight to others-1
         ,pid
         ,attr1_2:shar1_2                        # exp weight to others-3
         # ,attr1_3:shar1_3                        # exp weight to others-4
         )

titles <- c("Expectation by Gender (before)",
            "Expectation by Gender (one day later)",
            "Expectation by Gender (weeks later)")
time <- c("before","one day later","weeks later")
gender_exp_bar=data.frame()
for (i in 1:2) {
  gender_exp_tmp <- gender_exp %>% 
    drop_na() %>% 
    select(iid,gender,paste("attr1_",i,sep = ""):paste("shar1_",i,sep = "")) %>% 
    rename("Attractive"=paste("attr1_",i,sep = ""),
           "Sincere"=paste("sinc1_",i,sep = ""),
           "Intelligent"=paste("intel1_",i,sep = ""),
           "Fun"=paste("fun1_",i,sep = ""),
           "Ambitious"=paste("amb1_",i,sep = ""),
           "Shared_hobbies"=paste("shar1_",i,sep = "")) %>%
    mutate(gender = ifelse(gender == 0, "Female","Male"),time=time[i]) %>% 
    gather(key="attribute",value="weight",-iid,-gender,-time) %>% 
    unique()
  
  gender_exp_tmp$attribute <- factor(gender_exp_tmp$attribute)
  gender_exp_tmp$gender <- factor(gender_exp_tmp$gender)
  gender_exp_tmp$time <- factor(gender_exp_tmp$time)
  
  gender_exp_bar <- rbind(gender_exp_bar,gender_exp_tmp)
}

gender_exp_bar <- gender_exp_bar %>% group_by(gender,time,attribute) %>% 
  summarise(weight=mean(weight)) %>% 
  mutate(weight=weight/sum(weight)*100) %>% 
  ungroup()
gender_exp_bar %>% 
  ggplot(aes(x=gender,y=weight,fill=reorder(attribute,-weight)))+
  geom_bar(position="stack", stat="identity")+
  facet_wrap(gender_exp_bar$time)+
  labs(fill = "Attributes",title = "Expectaion to Partners (by Gender)")+
  xlab("Gender")+
  ylab("Weight")+
  theme(legend.position = "none")+theme(axis.text.x = element_text(size = 14), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14))
```

By analyzing the expectation before and after the dating by gender, we found:

1. For both female and male, intelligence, sincerity and fun are important attributes they expected to see in their partners.

2. Female attached much more importance to ambition of their partners than male do, while male attached much more importance to attractivity of the partners than female do. 

3. There is no large difference of the expections after the datings. But the weight of attraction increased slightly in both female and male groups. To test whether these change last for a long time, we continued to do the following exploratory.

#### Do the Changes Last for a Long time? {-#i}

```{r}
gender_exp <- speed_dating %>% 
  select(iid,gender
         ,attr1_1:shar1_1                        # exp weight to others-1
         ,pid
         ,attr1_2:shar1_2                        # exp weight to others-3
         ,attr1_3:shar1_3                        # exp weight to others-4
         )

titles <- c("Expectation by Gender (before)",
            "Expectation by Gender (one day later)",
            "Expectation by Gender (weeks later)")
time <- c("before","one day later","weeks later")
gender_exp_bar=data.frame()
for (i in 1:3) {
  gender_exp_tmp <- gender_exp %>% 
    drop_na() %>% 
    select(iid,gender,paste("attr1_",i,sep = ""):paste("shar1_",i,sep = "")) %>% 
    rename("Attractive"=paste("attr1_",i,sep = ""),
           "Sincere"=paste("sinc1_",i,sep = ""),
           "Intelligent"=paste("intel1_",i,sep = ""),
           "Fun"=paste("fun1_",i,sep = ""),
           "Ambitious"=paste("amb1_",i,sep = ""),
           "Shared_hobbies"=paste("shar1_",i,sep = "")) %>%
    mutate(gender = ifelse(gender == 0, "Female","Male"),time=time[i]) %>% 
    gather(key="attribute",value="weight",-iid,-gender,-time) %>% 
    unique()
  
  gender_exp_tmp$attribute <- factor(gender_exp_tmp$attribute)
  gender_exp_tmp$gender <- factor(gender_exp_tmp$gender)
  gender_exp_tmp$time <- factor(gender_exp_tmp$time)
  
  gender_exp_bar <- rbind(gender_exp_bar,gender_exp_tmp)
}

gender_exp_bar <- gender_exp_bar %>% group_by(gender,time,attribute) %>% 
  summarise(weight=mean(weight)) %>% 
  mutate(weight=weight/sum(weight)*100) %>% 
  ungroup()
gender_exp_bar %>% 
  ggplot(aes(x=time,y=weight,color=gender,group=gender))+
  geom_line()+
  geom_point()+
  xlab("Time")+
  ylab("Weight")+
  facet_wrap(gender_exp_bar$attribute)+
  labs(color = "Attributes",title = "Expectaion to Partners (by Gender)")+
  theme(axis.text.x = element_text(size = 14,angle=30,hjust = 1), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14), strip.text.x = element_text(size = 12))
```


To check does the dating have a long-term influence on people's expectations towards their partners, we did an analysis basing on the observations who answered the questions two weeks after.
Although only part of the participants answered the questions again two weeks after the dating, there is still 6800 records (449 individuals). From the graph we found that one-time dating only has a short-term influence on people's expectations towards their partners. As time pass by, their expectations tended to come back to the level before the datings.

This finding is reasonable since they were only one-time datings. However, to get a conclusion about whether people's mind change after dating, we need to seperate the groups into matched and unmatched.


```{r}
gender_exp <- speed_dating %>% 
  select(iid,gender
         ,attr1_1:shar1_1                        # exp weight to others-1
         ,pid,match
         ,attr1_2:shar1_2                        # exp weight to others-3
         # ,attr1_3:shar1_3                        # exp weight to others-4
         )

titles <- c("Expectation by Gender (before)",
            "Expectation by Gender (one day later)",
            "Expectation by Gender (weeks later)")
time <- c("before","one day later","weeks later")
gender_exp_bar=data.frame()
for (i in 1:2) {
  gender_exp_tmp <- gender_exp %>% 
    drop_na() %>% 
    select(iid,gender,match,paste("attr1_",i,sep = ""):paste("shar1_",i,sep = "")) %>% 
    rename("Attractive"=paste("attr1_",i,sep = ""),
           "Sincere"=paste("sinc1_",i,sep = ""),
           "Intelligent"=paste("intel1_",i,sep = ""),
           "Fun"=paste("fun1_",i,sep = ""),
           "Ambitious"=paste("amb1_",i,sep = ""),
           "Shared_hobbies"=paste("shar1_",i,sep = "")) %>%
    mutate(gender = ifelse(gender == 0, "Female","Male"),
           match = ifelse(match == 1, "matched","unmatched"),
           time=time[i]) %>% 
    gather(key="attribute",value="weight",-iid,-gender,-time,-match) %>% 
    unique()
  
  gender_exp_tmp$attribute <- factor(gender_exp_tmp$attribute)
  gender_exp_tmp$gender <- factor(gender_exp_tmp$gender)
  gender_exp_tmp$time <- factor(gender_exp_tmp$time)
  gender_exp_tmp$match <- factor(gender_exp_tmp$match)
  
  gender_exp_bar <- rbind(gender_exp_bar,gender_exp_tmp)
}

gender_exp_bar <- gender_exp_bar %>% group_by(gender,time,match,attribute) %>% 
  summarise(weight=mean(weight)) %>% 
  mutate(weight=weight/sum(weight)*100) %>% 
  ungroup() %>% 
  spread(time,weight) %>% 
  mutate(change=`one day later`-before)

gender_exp_bar %>% 
  ggplot(aes(x=attribute,y=change,fill=attribute))+
  geom_bar(stat = "identity")+
  # geom_point()+
  facet_grid(gender_exp_bar$gender~gender_exp_bar$match)+
  labs(fill = "Attributes",title = "Expectaion to Partners (by Gender and Match)")+
  theme(axis.text.x = element_text(size = 14,angle=30,hjust = 1), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14), strip.text.x = element_text(size = 12))
```

There is no obvious difference between the expections of matched group and unmatched groups, which means whether people are on a dating or not does not influence their expections to their partners (if they are not dating secretly or with another person except for the one they meet in this event).

### Self-evaluation {-#i}

#### How Does Self-Evaluation Change Before and After Datings? {-#i}
```{r}
gender_eva <- speed_dating %>% 
  select(iid,gender,
         attr3_1:amb3_1                         # self-evaluate-1 (self)-1
         ,pid
         ,attr3_2:amb3_2                        # self-evaluate-1 (self)-3
         # ,attr3_3:amb3_3                        # self-evaluate-1 (self)-4
         )

time <- c("before","one day later","weeks later")

gender_eva_bar=data.frame()
for (i in 1:2) {
  gender_eva_tmp <- gender_eva %>% 
    drop_na() %>%   
    select(iid,gender,paste("attr3_",i,sep = ""):paste("amb3_",i,sep = "")) %>% 
    rename("Attractive"=paste("attr3_",i,sep = ""),
           "Sincere"=paste("sinc3_",i,sep = ""),
           "Intelligent"=paste("intel3_",i,sep = ""),
           "Fun"=paste("fun3_",i,sep = ""),
           "Ambitious"=paste("amb3_",i,sep = "")) %>%
    mutate(gender = ifelse(gender == 0, "Female","Male"),time=time[i]) %>% 
    gather(key="attribute",value="score",-iid,-gender,-time) %>% 
    unique()
  
  gender_eva_tmp$attribute <- factor(gender_eva_tmp$attribute)
  gender_eva_tmp$gender <- factor(gender_eva_tmp$gender)
  gender_eva_tmp$time <- factor(gender_eva_tmp$time)
  
  gender_eva_bar <- rbind(gender_eva_bar,gender_eva_tmp)
}

tmp <- gender_eva_bar %>% 
  spread(time,score) %>% 
  mutate(change=`one day later`-before) %>% 
  group_by(gender,attribute,change) %>% 
  summarise(n=n()) %>% 
  mutate(n=ifelse(gender=="Female",-n,n))

breaks_values <- pretty(tmp$n)

tmp %>% 
  ggplot(aes(x=change,y=n,fill=gender))+
  geom_bar(stat = "identity")+
  facet_grid(~tmp$attribute)+
  scale_y_continuous(breaks = breaks_values,
                     labels = abs(breaks_values))+
  labs(fill = "Gender",
       title = "Self-evaluation Changes (by Gender)",
       y="frequency")+
  theme(axis.text.x = element_text(angle = 30, hjust = 1),legend.position="bottom")+
  coord_flip()+
  xlab("Frenquency")+
  ylab("Change")+
  theme(axis.text.x = element_text(size = 14,angle=30,hjust = 1), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14), strip.text.x = element_text(size = 12))

```

#### Does match influence changes in self-evaluation? {-#i}

```{r }
gender_eva <- speed_dating %>% 
  select(iid,gender,
         attr3_1:amb3_1                         # self-evaluate-1 (self)-1
         ,pid,match
         ,attr3_2:amb3_2                        # self-evaluate-1 (self)-3
         ,attr3_3:amb3_3                        # self-evaluate-1 (self)-4
         )

time <- c("before","one day later","weeks later")

gender_eva_bar=data.frame()
for (i in 1:2) {
  gender_eva_tmp <- gender_eva %>% 
    drop_na() %>%   
    select(iid,gender,match,paste("attr3_",i,sep = ""):paste("amb3_",i,sep = "")) %>% 
    rename("Attractive"=paste("attr3_",i,sep = ""),
           "Sincere"=paste("sinc3_",i,sep = ""),
           "Intelligent"=paste("intel3_",i,sep = ""),
           "Fun"=paste("fun3_",i,sep = ""),
           "Ambitious"=paste("amb3_",i,sep = "")) %>%
    mutate(gender = ifelse(gender == 0, "Female","Male"),
           match = ifelse(match == 1, "matched","unmatched"),
           time=time[i]) %>% 
    gather(key="attribute",value="score",-iid,-gender,-time,-match) %>% 
    unique()
  
  gender_eva_tmp$attribute <- factor(gender_eva_tmp$attribute)
  gender_eva_tmp$gender <- factor(gender_eva_tmp$gender)
  gender_eva_tmp$time <- factor(gender_eva_tmp$time)
  gender_eva_tmp$match <- factor(gender_eva_tmp$match)
  
  gender_eva_bar <- rbind(gender_eva_bar,gender_eva_tmp)
}
  
tmp <- gender_eva_bar %>% 
  spread(time,score) %>% 
  mutate(change=`one day later`-before) %>% 
  group_by(gender,attribute,match,change) %>% 
  summarise(n=n()) %>% 
  mutate(n=ifelse(gender=="Female",-n,n))

breaks_values <- pretty(tmp$n)

tmp %>% 
  ggplot(aes(x=change,y=n,fill=gender))+
  geom_bar(stat = "identity")+
  facet_grid(tmp$match~tmp$attribute)+
  scale_y_continuous(breaks = breaks_values,
                     labels = abs(breaks_values))+
  labs(fill = "Gender",
       title = "Self-evaluation Changes (by Gender)",
       y="frequency")+
  theme(legend.position="bottom")+
  coord_flip()+
  xlab("Frequency")+
  ylab("Change")+
  theme(axis.text.x = element_text(size = 14,angle=30,hjust = 1), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14), strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12))

```

There is no large difference in self-evaluation regrading to the five attributes (ambitious, attractive, fun, intelligent and sincere) between females and males before and after the datings, nor the matching results influence their self-evaluation.

#### Does the Expectation Influence Whether or not They Decide to Date? {-#i}

Usually people choose to date with someone because he/she has some attributes that attract them. It is likely that people will choose to date with someone who have the expective attributes. To test this assumption, we did the following exploratory. 

```{r }
gender_mat <- speed_dating %>% 
  select(iid,gender
         ,attr1_1:shar1_1                        # exp weight to others-1
         ,attr3_1:amb3_1                         # self-evaluate-1 (self)-1
         ,pid,match,dec_o,samerace,goal
         ,attr:shar,like,prob                                   # score to others
  ) %>% 
  drop_na() %>% 
  mutate(gender = ifelse(gender == 0, "Female","Male"),
         dec_o=ifelse(dec_o==0,"No","Yes"),
         goal=ifelse(goal==3|goal==4,"Dating","Other")
         )
  
gender_mat$gender <- factor(gender_mat$gender)
gender_mat$dec_o <- factor(gender_mat$dec_o)
gender_mat$goal <- factor(gender_mat$goal)
```


```{r, warning=FALSE}
tmp <- gender_mat %>% select(iid,gender,dec_o,samerace,
                      attr:shar,like,prob,goal) %>%                       # score to others
  mutate(score=(attr+sinc+intel+fun+amb+shar)*100/60) %>% 
  group_by(gender,goal,score,dec_o) %>% 
  summarise(n=n()) %>% 
  mutate(n=ifelse(dec_o=="Yes",n,-n))

breaks_values <- pretty(tmp$n)

tmp %>% 
  ggplot(aes(x=score,y=n,width=1,fill=dec_o))+
  geom_bar(stat = "identity")+
  facet_grid(tmp$gender~tmp$goal,scales = "free")+
  scale_y_continuous(breaks = breaks_values,
                     labels = abs(breaks_values))+
  scale_fill_discrete(name="decision")+
  labs(title = "Does People Date with Higher Score People?", fill = "Decision")+
  theme(legend.position="bottom")+
  coord_flip()+
  xlab("Frequency")+
  ylab("Score")+
  theme(axis.text.x = element_text(size = 14,angle=30,hjust = 1), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14), strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12))
```

If people made their decisions based on the score they gave, for people they said "yes", the score for them should be higher than for those they said "no". But according to the graph, there is no difference between the distribution of the score between "yes" and "no" groups, even if we seperate people by their goal of participating the event excpet for the female groups whose goal is dating. In the female groups whose goal is dating, they tent to date with people who had higher scores.

### What Influence Their Decisions? {-#i}


```{r}
gender_mat %>% select(iid,gender,dec_o,samerace,
                      attr:shar,goal,like,prob) %>%                       # score to others
  mutate(score=(attr+sinc+intel+fun+amb+shar)*100/60) %>% 
  ggplot(aes(like,score,color=gender))+
  geom_point()+
  labs(title = "Scores and Likes")
```


The graph above shows that score and a good impression (`like`) of a person has a positive relationship, which means if scores did not influence people's decisions, a good impression mattered little.

```{r, fig.width=10,fig.height=4}
# prob: how likely do you think others will say yes to you?

tmp <- gender_mat %>% mutate(like=round(like)) %>% 
  group_by(gender,like,dec_o) %>% 
  summarise(n=n()) %>% 
  spread(dec_o,n) %>% 
  mutate(yn_ratio=Yes/No)
p1 <- tmp[!is.na(tmp$yn_ratio),] %>% 
  ggplot(aes(x=like,y=yn_ratio,color=gender))+
  geom_line()+
  geom_point()+
  scale_x_continuous(breaks = seq(0,10,2))+
  labs(x="Like",y="Yes-No Ratio of Decisions", color = "Gender")+
  theme(axis.text.x = element_text(size = 14,angle=30,hjust = 1), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14), strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12))
p2 <- tmp[!is.na(tmp$yn_ratio),] %>% 
  ggplot(aes(x=like,y=Yes+No,fill=gender))+
  geom_bar(stat="identity",position="dodge")+
  scale_x_continuous(breaks = seq(0,10,2))+
  labs(x="Like",y="Frequency", fill = "Gender")+
  theme(axis.text.x = element_text(size = 14,angle=30,hjust = 1), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14), strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12))
gridExtra::grid.arrange(p1,p2,nrow=1,top="Likes Do not Influence Decisions")


tmp <- gender_mat %>% mutate(prob=round(prob)) %>% 
  group_by(gender,prob,dec_o) %>% 
  summarise(n=n()) %>% 
  spread(dec_o,n) %>% 
  mutate(yn_ratio=Yes/No)
par(mfrow=c(1,2))
p3 <- tmp[!is.na(tmp$yn_ratio),] %>% 
  ggplot(aes(x=prob,y=yn_ratio,color=gender))+
  geom_line()+
  geom_point()+
  scale_x_continuous(breaks = seq(0,10,2))+
  labs(x="Probability of Being chosen",y="Yes-No Ratio of Decisions", color = "Gender")+
  theme(axis.text.x = element_text(size = 14,angle=30,hjust = 1), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14), strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12))
p4 <- tmp[!is.na(tmp$yn_ratio),] %>% 
  ggplot(aes(x=prob,y=Yes+No,fill=gender))+
  geom_bar(stat="identity",position="dodge")+
  scale_x_continuous(breaks = seq(0,10,2))+
  labs(x="Probability of Being Chosen",y="Frequency", fill = "Gender")+
  theme(axis.text.x = element_text(size = 14,angle=30,hjust = 1), axis.title.x = element_text(size = 16),axis.text.y = element_text(size = 14), axis.title.y = element_text(size = 16),plot.title = element_text(size = 20, face = "bold"),legend.title = element_text(size=16), legend.text = element_text(size=14), strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12))
gridExtra::grid.arrange(p3,p4,nrow=1,top="Others' Opinions Influence Decisions")

```


The first graph shows how much do people like their partners. And the second graph shows how likely do people think their partner would like to date with them, namely, say "yes" to them. The graph on the right side is the number of people who gave the score. We use yes-no ratio (the number of people who said "yes" against those who said "no") to denote the decision of the group. If the ratio is larger than one, means among the people who gave the score, the majority of them want to date with partners.

From the graph, we confirmed that whether or not a person like his/her partner did not have a large influence on his/her decision, namely, they did date with someone they like best. Instead, they tended to choose those who might like them. For females, if they thought a male was 70% likely to say "yes" to themselves, they will also say "yes". For males, if they thought a female was 80% likely to say "yes" to themselves, they will also say "yes".
