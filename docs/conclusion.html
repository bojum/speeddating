<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Conclusion | How to Get More Matches in Speed Dating</title>
  <meta name="description" content="Chapter 7 Conclusion | How to Get More Matches in Speed Dating" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Conclusion | How to Get More Matches in Speed Dating" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Conclusion | How to Get More Matches in Speed Dating" />
  
  
  

<meta name="author" content="Yingyu Cao (yc3713), Bo Jumrustanasan (pj2356), Zhi Qi (zq2175)" />


<meta name="date" content="2019-12-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="interactive-component.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.46.1/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dating 101</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction-1"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#background"><i class="fa fa-check"></i><b>1.2</b> Background</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#our-goal"><i class="fa fa-check"></i><b>1.3</b> Our Goal</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#project-overview"><i class="fa fa-check"></i><b>1.4</b> Project Overview</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a><ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#experimental-design"><i class="fa fa-check"></i><b>2.1</b> Experimental Design</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#data-description"><i class="fa fa-check"></i><b>2.2</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a><ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#question-will-backrgound-and-common-interests-influence-the-match-which-feature-is-the-most-influential"><i class="fa fa-check"></i><b>5.1</b> Question: Will backrgound and common interests influence the match? Which feature is the most influential?</a></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#q2-how-males-and-females-expectation-and-self-evaluation-differs"><i class="fa fa-check"></i><b>5.2</b> Q2: How males and females’ expectation and self-evaluation differs?</a><ul>
<li class="chapter" data-level="5.2.1" data-path="results.html"><a href="results.html#expectations"><i class="fa fa-check"></i><b>5.2.1</b> Expectations</a></li>
<li class="chapter" data-level="5.2.2" data-path="results.html"><a href="results.html#self-evaluation"><i class="fa fa-check"></i><b>5.2.2</b> Self-evaluation</a></li>
<li class="chapter" data-level="5.2.3" data-path="results.html"><a href="results.html#what-influence-people-decisions"><i class="fa fa-check"></i><b>5.2.3</b> What influence people decisions?</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#question-do-people-with-excess-self-esteem-get-more-romantic-interest"><i class="fa fa-check"></i><b>5.3</b> Question: do people with excess self-esteem get more romantic interest?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a><ul>
<li class="chapter" data-level="7.1" data-path="conclusion.html"><a href="conclusion.html#q2-how-males-and-females-expectation-and-self-evaluation-differs-1"><i class="fa fa-check"></i><b>7.1</b> Q2: How males and females’ expectation and self-evaluation differs?</a><ul>
<li class="chapter" data-level="7.1.1" data-path="conclusion.html"><a href="conclusion.html#expectations-1"><i class="fa fa-check"></i><b>7.1.1</b> Expectations</a></li>
<li class="chapter" data-level="7.1.2" data-path="conclusion.html"><a href="conclusion.html#self-evaluation-1"><i class="fa fa-check"></i><b>7.1.2</b> Self-evaluation</a></li>
<li class="chapter" data-level="7.1.3" data-path="conclusion.html"><a href="conclusion.html#what-influence-people-decisions-1"><i class="fa fa-check"></i><b>7.1.3</b> What influence people decisions?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="conclusion.html"><a href="conclusion.html#question-will-backrgound-and-common-interests-influence-the-match-which-feature-is-the-most-influential-1"><i class="fa fa-check"></i><b>7.2</b> Question: Will backrgound and common interests influence the match? Which feature is the most influential?</a></li>
<li class="chapter" data-level="7.3" data-path="conclusion.html"><a href="conclusion.html#question-do-people-with-excess-self-esteem-get-more-romantic-interest-1"><i class="fa fa-check"></i><b>7.3</b> Question: do people with excess self-esteem get more romantic interest?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">How to Get More Matches in Speed Dating</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conclusion" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Conclusion</h1>

<div id="q2-how-males-and-females-expectation-and-self-evaluation-differs-1" class="section level2">
<h2><span class="header-section-number">7.1</span> Q2: How males and females’ expectation and self-evaluation differs?</h2>
<p>From the plot we found that only a small proportion of people participate in the experiment for dating, which meant they may not treat the dating seriously and just choose their partners randomly. So in this section, we explored whether people really chose to date with someone that meet their expectation, or they made their decision basing on other factors, and is there a difference between male and female. Another thing we were interested in is would males and females’ self-evaluation be influenced after they dating with someone.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;data/speed_dating.RData&quot;</span>)</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(iid,goal) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="st">  </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">goal=</span><span class="kw">ifelse</span>(goal<span class="op">==</span><span class="dv">1</span>,<span class="st">&quot;fun&quot;</span>,</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">                     <span class="kw">ifelse</span>(goal<span class="op">==</span><span class="dv">2</span>,<span class="st">&quot;making friends&quot;</span>,</a>
<a class="sourceLine" id="cb47-6" data-line-number="6">                            <span class="kw">ifelse</span>(goal<span class="op">==</span><span class="dv">3</span><span class="op">|</span>goal<span class="op">==</span><span class="dv">4</span>,<span class="st">&quot;dating&quot;</span>,</a>
<a class="sourceLine" id="cb47-7" data-line-number="7">                                   <span class="kw">ifelse</span>(goal<span class="op">==</span><span class="dv">5</span>,<span class="st">&quot;peer pressure&quot;</span>,<span class="st">&quot;others&quot;</span>))))) <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb47-8" data-line-number="8"><span class="st">  </span><span class="kw">unique</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(goal) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-10" data-line-number="10"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">frequency=</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dating=</span><span class="kw">ifelse</span>(goal<span class="op">==</span><span class="st">&quot;dating&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;No&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">reorder</span>(goal,frequency),<span class="dt">y=</span>frequency,<span class="dt">fill=</span>dating))<span class="op">+</span></a>
<a class="sourceLine" id="cb47-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb47-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;grey50&quot;</span>,<span class="st">&quot;lightblue&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb47-15" data-line-number="15"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;goal&quot;</span>,<span class="dt">title =</span> <span class="st">&quot;The Reason People Participate the Experiment&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb47-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>We define expectation as how people weight the importance of some attributes of their partners, and define self-evaluation of how people score their performance on those attributes. In this experiment people were asked their opinions about six attributes, which we descibed in section 2.2, to represent their expectation and five attributes to represent their self-evaluation (“share hobby” is dropped).</p>
<div id="expectations-1" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Expectations</h3>
<div id="how-does-males-and-females-expectation-change-before-and-after-datings-1" class="section level4">
<h4><span class="header-section-number">7.1.1.1</span> How does males and females’ expectation change before and after datings?</h4>
<p>In this part, we analyzed the weights of expectation in six attributes (attractive, sincere, intelligent, fun, ambitious and shared hobbies) between males and females, and how did the weight change after meeting someone.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">gender_exp &lt;-<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(iid,gender</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">         ,attr1_<span class="dv">1</span><span class="op">:</span>shar1_<span class="dv">1</span>                        <span class="co"># exp weight to others-1</span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4">         ,pid</a>
<a class="sourceLine" id="cb48-5" data-line-number="5">         ,attr1_<span class="dv">2</span><span class="op">:</span>shar1_<span class="dv">2</span>                        <span class="co"># exp weight to others-3</span></a>
<a class="sourceLine" id="cb48-6" data-line-number="6">         <span class="co"># ,attr1_3:shar1_3                        # exp weight to others-4</span></a>
<a class="sourceLine" id="cb48-7" data-line-number="7">         )</a>
<a class="sourceLine" id="cb48-8" data-line-number="8"></a>
<a class="sourceLine" id="cb48-9" data-line-number="9">titles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Expectation by Gender (before)&quot;</span>,</a>
<a class="sourceLine" id="cb48-10" data-line-number="10">            <span class="st">&quot;Expectation by Gender (one day later)&quot;</span>,</a>
<a class="sourceLine" id="cb48-11" data-line-number="11">            <span class="st">&quot;Expectation by Gender (weeks later)&quot;</span>)</a>
<a class="sourceLine" id="cb48-12" data-line-number="12">time &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;before&quot;</span>,<span class="st">&quot;one day later&quot;</span>,<span class="st">&quot;weeks later&quot;</span>)</a>
<a class="sourceLine" id="cb48-13" data-line-number="13">gender_exp_bar=<span class="kw">data.frame</span>()</a>
<a class="sourceLine" id="cb48-14" data-line-number="14"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</a>
<a class="sourceLine" id="cb48-15" data-line-number="15">  gender_exp_tmp &lt;-<span class="st"> </span>gender_exp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-16" data-line-number="16"><span class="st">    </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-17" data-line-number="17"><span class="st">    </span><span class="kw">select</span>(iid,gender,<span class="kw">paste</span>(<span class="st">&quot;attr1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)<span class="op">:</span><span class="kw">paste</span>(<span class="st">&quot;shar1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-18" data-line-number="18"><span class="st">    </span><span class="kw">rename</span>(<span class="st">&quot;Attractive&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;attr1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb48-19" data-line-number="19">           <span class="st">&quot;Sincere&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;sinc1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb48-20" data-line-number="20">           <span class="st">&quot;Intelligent&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;intel1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb48-21" data-line-number="21">           <span class="st">&quot;Fun&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;fun1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb48-22" data-line-number="22">           <span class="st">&quot;Ambitious&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;amb1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb48-23" data-line-number="23">           <span class="st">&quot;Shared_hobbies&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;shar1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-24" data-line-number="24"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">ifelse</span>(gender <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>),<span class="dt">time=</span>time[i]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-25" data-line-number="25"><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key=</span><span class="st">&quot;attribute&quot;</span>,<span class="dt">value=</span><span class="st">&quot;weight&quot;</span>,<span class="op">-</span>iid,<span class="op">-</span>gender,<span class="op">-</span>time) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-26" data-line-number="26"><span class="st">    </span><span class="kw">unique</span>()</a>
<a class="sourceLine" id="cb48-27" data-line-number="27">  </a>
<a class="sourceLine" id="cb48-28" data-line-number="28">  gender_exp_tmp<span class="op">$</span>attribute &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_exp_tmp<span class="op">$</span>attribute)</a>
<a class="sourceLine" id="cb48-29" data-line-number="29">  gender_exp_tmp<span class="op">$</span>gender &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_exp_tmp<span class="op">$</span>gender)</a>
<a class="sourceLine" id="cb48-30" data-line-number="30">  gender_exp_tmp<span class="op">$</span>time &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_exp_tmp<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb48-31" data-line-number="31">  </a>
<a class="sourceLine" id="cb48-32" data-line-number="32">  gender_exp_bar &lt;-<span class="st"> </span><span class="kw">rbind</span>(gender_exp_bar,gender_exp_tmp)</a>
<a class="sourceLine" id="cb48-33" data-line-number="33">}</a>
<a class="sourceLine" id="cb48-34" data-line-number="34"></a>
<a class="sourceLine" id="cb48-35" data-line-number="35">gender_exp_bar &lt;-<span class="st"> </span>gender_exp_bar <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(gender,time,attribute) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-36" data-line-number="36"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">weight=</span><span class="kw">mean</span>(weight)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-37" data-line-number="37"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weight=</span>weight<span class="op">/</span><span class="kw">sum</span>(weight)<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-38" data-line-number="38"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb48-39" data-line-number="39">gender_exp_bar <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-40" data-line-number="40"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>gender,<span class="dt">y=</span>weight,<span class="dt">fill=</span><span class="kw">reorder</span>(attribute,<span class="op">-</span>weight)))<span class="op">+</span></a>
<a class="sourceLine" id="cb48-41" data-line-number="41"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>, <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb48-42" data-line-number="42"><span class="st">  </span><span class="kw">facet_wrap</span>(gender_exp_bar<span class="op">$</span>time)<span class="op">+</span></a>
<a class="sourceLine" id="cb48-43" data-line-number="43"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Attributes&quot;</span>,<span class="dt">title =</span> <span class="st">&quot;Expectaion to Partners (by Gender)&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>By analyzing the expectation before and after the dating by gender, we found:</p>
<ol style="list-style-type: decimal">
<li><p>For both female and male, intelligence, sincerity and fun are important attributes they expected to see in their partners.</p></li>
<li><p>Female attached much more importance to ambition of their partners than male do, while male attached much more importance to attractivity of the partners than female do.</p></li>
<li><p>There is no large difference of the expections after the datings. But the weight of attraction increased slightly in both female and male groups. To test whether these change last for a long time, we continued to do the following exploratory.</p></li>
</ol>
</div>
<div id="does-the-changes-last-for-a-long-time-1" class="section level4">
<h4><span class="header-section-number">7.1.1.2</span> Does the changes last for a long time?</h4>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">gender_exp &lt;-<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(iid,gender</a>
<a class="sourceLine" id="cb49-3" data-line-number="3">         ,attr1_<span class="dv">1</span><span class="op">:</span>shar1_<span class="dv">1</span>                        <span class="co"># exp weight to others-1</span></a>
<a class="sourceLine" id="cb49-4" data-line-number="4">         ,pid</a>
<a class="sourceLine" id="cb49-5" data-line-number="5">         ,attr1_<span class="dv">2</span><span class="op">:</span>shar1_<span class="dv">2</span>                        <span class="co"># exp weight to others-3</span></a>
<a class="sourceLine" id="cb49-6" data-line-number="6">         ,attr1_<span class="dv">3</span><span class="op">:</span>shar1_<span class="dv">3</span>                        <span class="co"># exp weight to others-4</span></a>
<a class="sourceLine" id="cb49-7" data-line-number="7">         )</a>
<a class="sourceLine" id="cb49-8" data-line-number="8"></a>
<a class="sourceLine" id="cb49-9" data-line-number="9">titles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Expectation by Gender (before)&quot;</span>,</a>
<a class="sourceLine" id="cb49-10" data-line-number="10">            <span class="st">&quot;Expectation by Gender (one day later)&quot;</span>,</a>
<a class="sourceLine" id="cb49-11" data-line-number="11">            <span class="st">&quot;Expectation by Gender (weeks later)&quot;</span>)</a>
<a class="sourceLine" id="cb49-12" data-line-number="12">time &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;before&quot;</span>,<span class="st">&quot;one day later&quot;</span>,<span class="st">&quot;weeks later&quot;</span>)</a>
<a class="sourceLine" id="cb49-13" data-line-number="13">gender_exp_bar=<span class="kw">data.frame</span>()</a>
<a class="sourceLine" id="cb49-14" data-line-number="14"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb49-15" data-line-number="15">  gender_exp_tmp &lt;-<span class="st"> </span>gender_exp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-16" data-line-number="16"><span class="st">    </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-17" data-line-number="17"><span class="st">    </span><span class="kw">select</span>(iid,gender,<span class="kw">paste</span>(<span class="st">&quot;attr1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)<span class="op">:</span><span class="kw">paste</span>(<span class="st">&quot;shar1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-18" data-line-number="18"><span class="st">    </span><span class="kw">rename</span>(<span class="st">&quot;Attractive&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;attr1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb49-19" data-line-number="19">           <span class="st">&quot;Sincere&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;sinc1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb49-20" data-line-number="20">           <span class="st">&quot;Intelligent&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;intel1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb49-21" data-line-number="21">           <span class="st">&quot;Fun&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;fun1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb49-22" data-line-number="22">           <span class="st">&quot;Ambitious&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;amb1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb49-23" data-line-number="23">           <span class="st">&quot;Shared_hobbies&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;shar1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-24" data-line-number="24"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">ifelse</span>(gender <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>),<span class="dt">time=</span>time[i]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-25" data-line-number="25"><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key=</span><span class="st">&quot;attribute&quot;</span>,<span class="dt">value=</span><span class="st">&quot;weight&quot;</span>,<span class="op">-</span>iid,<span class="op">-</span>gender,<span class="op">-</span>time) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-26" data-line-number="26"><span class="st">    </span><span class="kw">unique</span>()</a>
<a class="sourceLine" id="cb49-27" data-line-number="27">  </a>
<a class="sourceLine" id="cb49-28" data-line-number="28">  gender_exp_tmp<span class="op">$</span>attribute &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_exp_tmp<span class="op">$</span>attribute)</a>
<a class="sourceLine" id="cb49-29" data-line-number="29">  gender_exp_tmp<span class="op">$</span>gender &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_exp_tmp<span class="op">$</span>gender)</a>
<a class="sourceLine" id="cb49-30" data-line-number="30">  gender_exp_tmp<span class="op">$</span>time &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_exp_tmp<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb49-31" data-line-number="31">  </a>
<a class="sourceLine" id="cb49-32" data-line-number="32">  gender_exp_bar &lt;-<span class="st"> </span><span class="kw">rbind</span>(gender_exp_bar,gender_exp_tmp)</a>
<a class="sourceLine" id="cb49-33" data-line-number="33">}</a>
<a class="sourceLine" id="cb49-34" data-line-number="34"></a>
<a class="sourceLine" id="cb49-35" data-line-number="35">gender_exp_bar &lt;-<span class="st"> </span>gender_exp_bar <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(gender,time,attribute) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-36" data-line-number="36"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">weight=</span><span class="kw">mean</span>(weight)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-37" data-line-number="37"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weight=</span>weight<span class="op">/</span><span class="kw">sum</span>(weight)<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-38" data-line-number="38"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb49-39" data-line-number="39">gender_exp_bar <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-40" data-line-number="40"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time,<span class="dt">y=</span>weight,<span class="dt">color=</span>gender,<span class="dt">group=</span>gender))<span class="op">+</span></a>
<a class="sourceLine" id="cb49-41" data-line-number="41"><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb49-42" data-line-number="42"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb49-43" data-line-number="43"><span class="st">  </span><span class="kw">facet_wrap</span>(gender_exp_bar<span class="op">$</span>attribute)<span class="op">+</span></a>
<a class="sourceLine" id="cb49-44" data-line-number="44"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&quot;Attributes&quot;</span>,<span class="dt">title =</span> <span class="st">&quot;Expectaion to Partners (by Gender)&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb49-45" data-line-number="45"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">30</span>,<span class="dt">hjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>To check does the dating have a long-term influence on people’s expectations towards their partners, we did an analysis basing on the observations who answered the questions two weeks after.
Although only part of the participants answered the questions again two weeks after the dating, there is still 6800 records (449 individuals). From the graph we found that one-time dating only has a short-term influence on people’s expectations towards their partners. As time pass by, their expectations tended to come back to the level before the datings.</p>
<p>This finding is reasonable since they were only one-time datings. However, to get a conclusion about whether people’s mind change after dating, we need to seperate the groups into matched and unmatched.</p>
</div>
<div id="does-match-influence-changes-in-expectation-1" class="section level4">
<h4><span class="header-section-number">7.1.1.3</span> Does match influence changes in expectation?</h4>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">gender_exp &lt;-<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(iid,gender</a>
<a class="sourceLine" id="cb50-3" data-line-number="3">         ,attr1_<span class="dv">1</span><span class="op">:</span>shar1_<span class="dv">1</span>                        <span class="co"># exp weight to others-1</span></a>
<a class="sourceLine" id="cb50-4" data-line-number="4">         ,pid,match</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">         ,attr1_<span class="dv">2</span><span class="op">:</span>shar1_<span class="dv">2</span>                        <span class="co"># exp weight to others-3</span></a>
<a class="sourceLine" id="cb50-6" data-line-number="6">         <span class="co"># ,attr1_3:shar1_3                        # exp weight to others-4</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7">         )</a>
<a class="sourceLine" id="cb50-8" data-line-number="8"></a>
<a class="sourceLine" id="cb50-9" data-line-number="9">titles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Expectation by Gender (before)&quot;</span>,</a>
<a class="sourceLine" id="cb50-10" data-line-number="10">            <span class="st">&quot;Expectation by Gender (one day later)&quot;</span>,</a>
<a class="sourceLine" id="cb50-11" data-line-number="11">            <span class="st">&quot;Expectation by Gender (weeks later)&quot;</span>)</a>
<a class="sourceLine" id="cb50-12" data-line-number="12">time &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;before&quot;</span>,<span class="st">&quot;one day later&quot;</span>,<span class="st">&quot;weeks later&quot;</span>)</a>
<a class="sourceLine" id="cb50-13" data-line-number="13">gender_exp_bar=<span class="kw">data.frame</span>()</a>
<a class="sourceLine" id="cb50-14" data-line-number="14"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</a>
<a class="sourceLine" id="cb50-15" data-line-number="15">  gender_exp_tmp &lt;-<span class="st"> </span>gender_exp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-16" data-line-number="16"><span class="st">    </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-17" data-line-number="17"><span class="st">    </span><span class="kw">select</span>(iid,gender,match,<span class="kw">paste</span>(<span class="st">&quot;attr1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)<span class="op">:</span><span class="kw">paste</span>(<span class="st">&quot;shar1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-18" data-line-number="18"><span class="st">    </span><span class="kw">rename</span>(<span class="st">&quot;Attractive&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;attr1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb50-19" data-line-number="19">           <span class="st">&quot;Sincere&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;sinc1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb50-20" data-line-number="20">           <span class="st">&quot;Intelligent&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;intel1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb50-21" data-line-number="21">           <span class="st">&quot;Fun&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;fun1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb50-22" data-line-number="22">           <span class="st">&quot;Ambitious&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;amb1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb50-23" data-line-number="23">           <span class="st">&quot;Shared_hobbies&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;shar1_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-24" data-line-number="24"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">ifelse</span>(gender <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>),</a>
<a class="sourceLine" id="cb50-25" data-line-number="25">           <span class="dt">match =</span> <span class="kw">ifelse</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;matched&quot;</span>,<span class="st">&quot;unmatched&quot;</span>),</a>
<a class="sourceLine" id="cb50-26" data-line-number="26">           <span class="dt">time=</span>time[i]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-27" data-line-number="27"><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key=</span><span class="st">&quot;attribute&quot;</span>,<span class="dt">value=</span><span class="st">&quot;weight&quot;</span>,<span class="op">-</span>iid,<span class="op">-</span>gender,<span class="op">-</span>time,<span class="op">-</span>match) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-28" data-line-number="28"><span class="st">    </span><span class="kw">unique</span>()</a>
<a class="sourceLine" id="cb50-29" data-line-number="29">  </a>
<a class="sourceLine" id="cb50-30" data-line-number="30">  gender_exp_tmp<span class="op">$</span>attribute &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_exp_tmp<span class="op">$</span>attribute)</a>
<a class="sourceLine" id="cb50-31" data-line-number="31">  gender_exp_tmp<span class="op">$</span>gender &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_exp_tmp<span class="op">$</span>gender)</a>
<a class="sourceLine" id="cb50-32" data-line-number="32">  gender_exp_tmp<span class="op">$</span>time &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_exp_tmp<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb50-33" data-line-number="33">  gender_exp_tmp<span class="op">$</span>match &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_exp_tmp<span class="op">$</span>match)</a>
<a class="sourceLine" id="cb50-34" data-line-number="34">  </a>
<a class="sourceLine" id="cb50-35" data-line-number="35">  gender_exp_bar &lt;-<span class="st"> </span><span class="kw">rbind</span>(gender_exp_bar,gender_exp_tmp)</a>
<a class="sourceLine" id="cb50-36" data-line-number="36">}</a>
<a class="sourceLine" id="cb50-37" data-line-number="37"></a>
<a class="sourceLine" id="cb50-38" data-line-number="38">gender_exp_bar &lt;-<span class="st"> </span>gender_exp_bar <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(gender,time,match,attribute) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-39" data-line-number="39"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">weight=</span><span class="kw">mean</span>(weight)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-40" data-line-number="40"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weight=</span>weight<span class="op">/</span><span class="kw">sum</span>(weight)<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-41" data-line-number="41"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-42" data-line-number="42"><span class="st">  </span><span class="kw">spread</span>(time,weight) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-43" data-line-number="43"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">change=</span><span class="st">`</span><span class="dt">one day later</span><span class="st">`</span><span class="op">-</span>before)</a>
<a class="sourceLine" id="cb50-44" data-line-number="44"></a>
<a class="sourceLine" id="cb50-45" data-line-number="45">gender_exp_bar <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-46" data-line-number="46"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>attribute,<span class="dt">y=</span>change,<span class="dt">fill=</span>attribute))<span class="op">+</span></a>
<a class="sourceLine" id="cb50-47" data-line-number="47"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb50-48" data-line-number="48"><span class="st">  </span><span class="co"># geom_point()+</span></a>
<a class="sourceLine" id="cb50-49" data-line-number="49"><span class="st">  </span><span class="kw">facet_grid</span>(gender_exp_bar<span class="op">$</span>gender<span class="op">~</span>gender_exp_bar<span class="op">$</span>match)<span class="op">+</span></a>
<a class="sourceLine" id="cb50-50" data-line-number="50"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&quot;Attributes&quot;</span>,<span class="dt">title =</span> <span class="st">&quot;Expectaion to Partners (by Gender and Match)&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb50-51" data-line-number="51"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">30</span>,<span class="dt">hjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>There is no obvious difference between the expections of matched group and unmatched groups, which means whether people are on a dating or not does not influence their expections to their partners (if they are not dating secretly or with another person except for the one they meet in this event).</p>
</div>
</div>
<div id="self-evaluation-1" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Self-evaluation</h3>
<div id="how-does-self-evaluation-change-before-and-after-datings-1" class="section level4">
<h4><span class="header-section-number">7.1.2.1</span> How does self-evaluation change before and after datings?</h4>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">gender_eva &lt;-<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(iid,gender,</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">         attr3_<span class="dv">1</span><span class="op">:</span>amb3_<span class="dv">1</span>                         <span class="co"># self-evaluate-1 (self)-1</span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4">         ,pid</a>
<a class="sourceLine" id="cb51-5" data-line-number="5">         ,attr3_<span class="dv">2</span><span class="op">:</span>amb3_<span class="dv">2</span>                        <span class="co"># self-evaluate-1 (self)-3</span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6">         <span class="co"># ,attr3_3:amb3_3                        # self-evaluate-1 (self)-4</span></a>
<a class="sourceLine" id="cb51-7" data-line-number="7">         )</a>
<a class="sourceLine" id="cb51-8" data-line-number="8"></a>
<a class="sourceLine" id="cb51-9" data-line-number="9">time &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;before&quot;</span>,<span class="st">&quot;one day later&quot;</span>,<span class="st">&quot;weeks later&quot;</span>)</a>
<a class="sourceLine" id="cb51-10" data-line-number="10"></a>
<a class="sourceLine" id="cb51-11" data-line-number="11">gender_eva_bar=<span class="kw">data.frame</span>()</a>
<a class="sourceLine" id="cb51-12" data-line-number="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</a>
<a class="sourceLine" id="cb51-13" data-line-number="13">  gender_eva_tmp &lt;-<span class="st"> </span>gender_eva <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-14" data-line-number="14"><span class="st">    </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb51-15" data-line-number="15"><span class="st">    </span><span class="kw">select</span>(iid,gender,<span class="kw">paste</span>(<span class="st">&quot;attr3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)<span class="op">:</span><span class="kw">paste</span>(<span class="st">&quot;amb3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-16" data-line-number="16"><span class="st">    </span><span class="kw">rename</span>(<span class="st">&quot;Attractive&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;attr3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb51-17" data-line-number="17">           <span class="st">&quot;Sincere&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;sinc3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb51-18" data-line-number="18">           <span class="st">&quot;Intelligent&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;intel3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb51-19" data-line-number="19">           <span class="st">&quot;Fun&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;fun3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb51-20" data-line-number="20">           <span class="st">&quot;Ambitious&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;amb3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-21" data-line-number="21"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">ifelse</span>(gender <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>),<span class="dt">time=</span>time[i]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-22" data-line-number="22"><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key=</span><span class="st">&quot;attribute&quot;</span>,<span class="dt">value=</span><span class="st">&quot;score&quot;</span>,<span class="op">-</span>iid,<span class="op">-</span>gender,<span class="op">-</span>time) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-23" data-line-number="23"><span class="st">    </span><span class="kw">unique</span>()</a>
<a class="sourceLine" id="cb51-24" data-line-number="24">  </a>
<a class="sourceLine" id="cb51-25" data-line-number="25">  gender_eva_tmp<span class="op">$</span>attribute &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_eva_tmp<span class="op">$</span>attribute)</a>
<a class="sourceLine" id="cb51-26" data-line-number="26">  gender_eva_tmp<span class="op">$</span>gender &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_eva_tmp<span class="op">$</span>gender)</a>
<a class="sourceLine" id="cb51-27" data-line-number="27">  gender_eva_tmp<span class="op">$</span>time &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_eva_tmp<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb51-28" data-line-number="28">  </a>
<a class="sourceLine" id="cb51-29" data-line-number="29">  gender_eva_bar &lt;-<span class="st"> </span><span class="kw">rbind</span>(gender_eva_bar,gender_eva_tmp)</a>
<a class="sourceLine" id="cb51-30" data-line-number="30">}</a>
<a class="sourceLine" id="cb51-31" data-line-number="31"></a>
<a class="sourceLine" id="cb51-32" data-line-number="32">tmp &lt;-<span class="st"> </span>gender_eva_bar <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-33" data-line-number="33"><span class="st">  </span><span class="kw">spread</span>(time,score) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-34" data-line-number="34"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">change=</span><span class="st">`</span><span class="dt">one day later</span><span class="st">`</span><span class="op">-</span>before) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-35" data-line-number="35"><span class="st">  </span><span class="kw">group_by</span>(gender,attribute,change) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-36" data-line-number="36"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-37" data-line-number="37"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n=</span><span class="kw">ifelse</span>(gender<span class="op">==</span><span class="st">&quot;Female&quot;</span>,<span class="op">-</span>n,n))</a>
<a class="sourceLine" id="cb51-38" data-line-number="38"></a>
<a class="sourceLine" id="cb51-39" data-line-number="39">breaks_values &lt;-<span class="st"> </span><span class="kw">pretty</span>(tmp<span class="op">$</span>n)</a>
<a class="sourceLine" id="cb51-40" data-line-number="40"></a>
<a class="sourceLine" id="cb51-41" data-line-number="41">tmp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-42" data-line-number="42"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>change,<span class="dt">y=</span>n,<span class="dt">fill=</span>gender))<span class="op">+</span></a>
<a class="sourceLine" id="cb51-43" data-line-number="43"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb51-44" data-line-number="44"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>tmp<span class="op">$</span>attribute)<span class="op">+</span></a>
<a class="sourceLine" id="cb51-45" data-line-number="45"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> breaks_values,</a>
<a class="sourceLine" id="cb51-46" data-line-number="46">                     <span class="dt">labels =</span> <span class="kw">abs</span>(breaks_values))<span class="op">+</span></a>
<a class="sourceLine" id="cb51-47" data-line-number="47"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Gender&quot;</span>,</a>
<a class="sourceLine" id="cb51-48" data-line-number="48">       <span class="dt">title =</span> <span class="st">&quot;Self-evaluation Changes (by Gender)&quot;</span>,</a>
<a class="sourceLine" id="cb51-49" data-line-number="49">       <span class="dt">y=</span><span class="st">&quot;frequency&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb51-50" data-line-number="50"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">30</span>, <span class="dt">hjust =</span> <span class="dv">1</span>),<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb51-51" data-line-number="51"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="does-match-influence-changes-in-self-evaluation-1" class="section level4">
<h4><span class="header-section-number">7.1.2.2</span> Does match influence changes in self-evaluation?</h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">gender_eva &lt;-<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(iid,gender,</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">         attr3_<span class="dv">1</span><span class="op">:</span>amb3_<span class="dv">1</span>                         <span class="co"># self-evaluate-1 (self)-1</span></a>
<a class="sourceLine" id="cb52-4" data-line-number="4">         ,pid,match</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">         ,attr3_<span class="dv">2</span><span class="op">:</span>amb3_<span class="dv">2</span>                        <span class="co"># self-evaluate-1 (self)-3</span></a>
<a class="sourceLine" id="cb52-6" data-line-number="6">         ,attr3_<span class="dv">3</span><span class="op">:</span>amb3_<span class="dv">3</span>                        <span class="co"># self-evaluate-1 (self)-4</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7">         )</a>
<a class="sourceLine" id="cb52-8" data-line-number="8"></a>
<a class="sourceLine" id="cb52-9" data-line-number="9">time &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;before&quot;</span>,<span class="st">&quot;one day later&quot;</span>,<span class="st">&quot;weeks later&quot;</span>)</a>
<a class="sourceLine" id="cb52-10" data-line-number="10"></a>
<a class="sourceLine" id="cb52-11" data-line-number="11">gender_eva_bar=<span class="kw">data.frame</span>()</a>
<a class="sourceLine" id="cb52-12" data-line-number="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</a>
<a class="sourceLine" id="cb52-13" data-line-number="13">  gender_eva_tmp &lt;-<span class="st"> </span>gender_eva <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-14" data-line-number="14"><span class="st">    </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb52-15" data-line-number="15"><span class="st">    </span><span class="kw">select</span>(iid,gender,match,<span class="kw">paste</span>(<span class="st">&quot;attr3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)<span class="op">:</span><span class="kw">paste</span>(<span class="st">&quot;amb3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-16" data-line-number="16"><span class="st">    </span><span class="kw">rename</span>(<span class="st">&quot;Attractive&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;attr3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb52-17" data-line-number="17">           <span class="st">&quot;Sincere&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;sinc3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb52-18" data-line-number="18">           <span class="st">&quot;Intelligent&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;intel3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb52-19" data-line-number="19">           <span class="st">&quot;Fun&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;fun3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb52-20" data-line-number="20">           <span class="st">&quot;Ambitious&quot;</span>=<span class="kw">paste</span>(<span class="st">&quot;amb3_&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-21" data-line-number="21"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">ifelse</span>(gender <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>),</a>
<a class="sourceLine" id="cb52-22" data-line-number="22">           <span class="dt">match =</span> <span class="kw">ifelse</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;matched&quot;</span>,<span class="st">&quot;unmatched&quot;</span>),</a>
<a class="sourceLine" id="cb52-23" data-line-number="23">           <span class="dt">time=</span>time[i]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-24" data-line-number="24"><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key=</span><span class="st">&quot;attribute&quot;</span>,<span class="dt">value=</span><span class="st">&quot;score&quot;</span>,<span class="op">-</span>iid,<span class="op">-</span>gender,<span class="op">-</span>time,<span class="op">-</span>match) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-25" data-line-number="25"><span class="st">    </span><span class="kw">unique</span>()</a>
<a class="sourceLine" id="cb52-26" data-line-number="26">  </a>
<a class="sourceLine" id="cb52-27" data-line-number="27">  gender_eva_tmp<span class="op">$</span>attribute &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_eva_tmp<span class="op">$</span>attribute)</a>
<a class="sourceLine" id="cb52-28" data-line-number="28">  gender_eva_tmp<span class="op">$</span>gender &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_eva_tmp<span class="op">$</span>gender)</a>
<a class="sourceLine" id="cb52-29" data-line-number="29">  gender_eva_tmp<span class="op">$</span>time &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_eva_tmp<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb52-30" data-line-number="30">  gender_eva_tmp<span class="op">$</span>match &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_eva_tmp<span class="op">$</span>match)</a>
<a class="sourceLine" id="cb52-31" data-line-number="31">  </a>
<a class="sourceLine" id="cb52-32" data-line-number="32">  gender_eva_bar &lt;-<span class="st"> </span><span class="kw">rbind</span>(gender_eva_bar,gender_eva_tmp)</a>
<a class="sourceLine" id="cb52-33" data-line-number="33">}</a>
<a class="sourceLine" id="cb52-34" data-line-number="34">  </a>
<a class="sourceLine" id="cb52-35" data-line-number="35">tmp &lt;-<span class="st"> </span>gender_eva_bar <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-36" data-line-number="36"><span class="st">  </span><span class="kw">spread</span>(time,score) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-37" data-line-number="37"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">change=</span><span class="st">`</span><span class="dt">one day later</span><span class="st">`</span><span class="op">-</span>before) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-38" data-line-number="38"><span class="st">  </span><span class="kw">group_by</span>(gender,attribute,match,change) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-39" data-line-number="39"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-40" data-line-number="40"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n=</span><span class="kw">ifelse</span>(gender<span class="op">==</span><span class="st">&quot;Female&quot;</span>,<span class="op">-</span>n,n))</a>
<a class="sourceLine" id="cb52-41" data-line-number="41"></a>
<a class="sourceLine" id="cb52-42" data-line-number="42">breaks_values &lt;-<span class="st"> </span><span class="kw">pretty</span>(tmp<span class="op">$</span>n)</a>
<a class="sourceLine" id="cb52-43" data-line-number="43"></a>
<a class="sourceLine" id="cb52-44" data-line-number="44">tmp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-45" data-line-number="45"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>change,<span class="dt">y=</span>n,<span class="dt">fill=</span>gender))<span class="op">+</span></a>
<a class="sourceLine" id="cb52-46" data-line-number="46"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb52-47" data-line-number="47"><span class="st">  </span><span class="kw">facet_grid</span>(tmp<span class="op">$</span>match<span class="op">~</span>tmp<span class="op">$</span>attribute)<span class="op">+</span></a>
<a class="sourceLine" id="cb52-48" data-line-number="48"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> breaks_values,</a>
<a class="sourceLine" id="cb52-49" data-line-number="49">                     <span class="dt">labels =</span> <span class="kw">abs</span>(breaks_values))<span class="op">+</span></a>
<a class="sourceLine" id="cb52-50" data-line-number="50"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Gender&quot;</span>,</a>
<a class="sourceLine" id="cb52-51" data-line-number="51">       <span class="dt">title =</span> <span class="st">&quot;Self-evaluation Changes (by Gender)&quot;</span>,</a>
<a class="sourceLine" id="cb52-52" data-line-number="52">       <span class="dt">y=</span><span class="st">&quot;frequency&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb52-53" data-line-number="53"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb52-54" data-line-number="54"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>There is no large difference in self-evaluation regrading to the five attributes (ambitious, attractive, fun, intelligent and sincere) between females and males before and after the datings, nor the matching results influence their self-evaluation.</p>
</div>
<div id="does-the-expectation-influence-whether-or-not-they-decide-to-date-1" class="section level4">
<h4><span class="header-section-number">7.1.2.3</span> Does the expectation influence whether or not they decide to date?</h4>
<p>Usually people choose to date with someone because he/she has some attributes that attract them. It is likely that people will choose to date with someone who have the expective attributes. To test this assumption, we did the following exploratory.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">gender_mat &lt;-<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(iid,gender</a>
<a class="sourceLine" id="cb53-3" data-line-number="3">         ,attr1_<span class="dv">1</span><span class="op">:</span>shar1_<span class="dv">1</span>                        <span class="co"># exp weight to others-1</span></a>
<a class="sourceLine" id="cb53-4" data-line-number="4">         ,attr3_<span class="dv">1</span><span class="op">:</span>amb3_<span class="dv">1</span>                         <span class="co"># self-evaluate-1 (self)-1</span></a>
<a class="sourceLine" id="cb53-5" data-line-number="5">         ,pid,match,dec_o,samerace,goal</a>
<a class="sourceLine" id="cb53-6" data-line-number="6">         ,attr<span class="op">:</span>shar,like,prob                                   <span class="co"># score to others</span></a>
<a class="sourceLine" id="cb53-7" data-line-number="7">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb53-8" data-line-number="8"><span class="st">  </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb53-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">ifelse</span>(gender <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>),</a>
<a class="sourceLine" id="cb53-10" data-line-number="10">         <span class="dt">dec_o=</span><span class="kw">ifelse</span>(dec_o<span class="op">==</span><span class="dv">0</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>),</a>
<a class="sourceLine" id="cb53-11" data-line-number="11">         <span class="dt">goal=</span><span class="kw">ifelse</span>(goal<span class="op">==</span><span class="dv">3</span><span class="op">|</span>goal<span class="op">==</span><span class="dv">4</span>,<span class="st">&quot;Dating&quot;</span>,<span class="st">&quot;Other&quot;</span>)</a>
<a class="sourceLine" id="cb53-12" data-line-number="12">         )</a>
<a class="sourceLine" id="cb53-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb53-14" data-line-number="14">gender_mat<span class="op">$</span>gender &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_mat<span class="op">$</span>gender)</a>
<a class="sourceLine" id="cb53-15" data-line-number="15">gender_mat<span class="op">$</span>dec_o &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_mat<span class="op">$</span>dec_o)</a>
<a class="sourceLine" id="cb53-16" data-line-number="16">gender_mat<span class="op">$</span>goal &lt;-<span class="st"> </span><span class="kw">factor</span>(gender_mat<span class="op">$</span>goal)</a></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">tmp &lt;-<span class="st"> </span>gender_mat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(iid,gender,dec_o,samerace,</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">                      attr<span class="op">:</span>shar,like,prob,goal) <span class="op">%&gt;%</span><span class="st">                       </span><span class="co"># score to others</span></a>
<a class="sourceLine" id="cb54-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">score=</span>(attr<span class="op">+</span>sinc<span class="op">+</span>intel<span class="op">+</span>fun<span class="op">+</span>amb<span class="op">+</span>shar)<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="dv">60</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(gender,goal,score,dec_o) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n=</span><span class="kw">ifelse</span>(dec_o<span class="op">==</span><span class="st">&quot;Yes&quot;</span>,n,<span class="op">-</span>n))</a>
<a class="sourceLine" id="cb54-7" data-line-number="7"></a>
<a class="sourceLine" id="cb54-8" data-line-number="8">breaks_values &lt;-<span class="st"> </span><span class="kw">pretty</span>(tmp<span class="op">$</span>n)</a>
<a class="sourceLine" id="cb54-9" data-line-number="9"></a>
<a class="sourceLine" id="cb54-10" data-line-number="10">tmp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-11" data-line-number="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>score,<span class="dt">y=</span>n,<span class="dt">width=</span><span class="dv">1</span>,<span class="dt">fill=</span>dec_o))<span class="op">+</span></a>
<a class="sourceLine" id="cb54-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb54-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_grid</span>(tmp<span class="op">$</span>gender<span class="op">~</span>tmp<span class="op">$</span>goal,<span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb54-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> breaks_values,</a>
<a class="sourceLine" id="cb54-15" data-line-number="15">                     <span class="dt">labels =</span> <span class="kw">abs</span>(breaks_values))<span class="op">+</span></a>
<a class="sourceLine" id="cb54-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">name=</span><span class="st">&quot;decision&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb54-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Does people date with higher score people?&quot;</span>,</a>
<a class="sourceLine" id="cb54-18" data-line-number="18">       <span class="dt">y=</span><span class="st">&quot;frequency&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb54-19" data-line-number="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb54-20" data-line-number="20"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>If people made their decisions based on the score they gave, for people they said “yes”, the score for them should be higher than for those they said “no”. But according to the graph, there is no difference between the distribution of the score between “yes” and “no” groups, even if we seperate people by their goal of participating the event excpet for the female groups whose goal is dating. In the female groups whose goal is dating, they tent to date with people who had higher scores.</p>
</div>
</div>
<div id="what-influence-people-decisions-1" class="section level3">
<h3><span class="header-section-number">7.1.3</span> What influence people decisions?</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">gender_mat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(iid,gender,dec_o,samerace,</a>
<a class="sourceLine" id="cb55-2" data-line-number="2">                      attr<span class="op">:</span>shar,goal,like,prob) <span class="op">%&gt;%</span><span class="st">                       </span><span class="co"># score to others</span></a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">score=</span>(attr<span class="op">+</span>sinc<span class="op">+</span>intel<span class="op">+</span>fun<span class="op">+</span>amb<span class="op">+</span>shar)<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="dv">60</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(like,score,<span class="dt">color=</span>gender))<span class="op">+</span></a>
<a class="sourceLine" id="cb55-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb55-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Scores and Likes&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>The graph above shows that score and a good impression (<code>like</code>) of a person has a positive relationship, which means if scores did not influence people’s decisions, a good impression mattered little.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="co"># prob: how likely do you think others will say yes to you?</span></a>
<a class="sourceLine" id="cb56-2" data-line-number="2"></a>
<a class="sourceLine" id="cb56-3" data-line-number="3">tmp &lt;-<span class="st"> </span>gender_mat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">like=</span><span class="kw">round</span>(like)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(gender,like,dec_o) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-6" data-line-number="6"><span class="st">  </span><span class="kw">spread</span>(dec_o,n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">yn_ratio=</span>Yes<span class="op">/</span>No)</a>
<a class="sourceLine" id="cb56-8" data-line-number="8">p1 &lt;-<span class="st"> </span>tmp[<span class="op">!</span><span class="kw">is.na</span>(tmp<span class="op">$</span>yn_ratio),] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>like,<span class="dt">y=</span>yn_ratio,<span class="dt">color=</span>gender))<span class="op">+</span></a>
<a class="sourceLine" id="cb56-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb56-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb56-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb56-13" data-line-number="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;like&quot;</span>,<span class="dt">y=</span><span class="st">&quot;yes-no ratio of decisions&quot;</span>)</a>
<a class="sourceLine" id="cb56-14" data-line-number="14">p2 &lt;-<span class="st"> </span>tmp[<span class="op">!</span><span class="kw">is.na</span>(tmp<span class="op">$</span>yn_ratio),] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>like,<span class="dt">y=</span>Yes<span class="op">+</span>No,<span class="dt">fill=</span>gender))<span class="op">+</span></a>
<a class="sourceLine" id="cb56-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb56-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb56-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;like&quot;</span>,<span class="dt">y=</span><span class="st">&quot;frequency&quot;</span>)</a>
<a class="sourceLine" id="cb56-19" data-line-number="19">gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(p1,p2,<span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">top=</span><span class="st">&quot;Likes Does not Influence Decisions&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="960" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">tmp &lt;-<span class="st"> </span>gender_mat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">prob=</span><span class="kw">round</span>(prob)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(gender,prob,dec_o) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="st">  </span><span class="kw">spread</span>(dec_o,n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">yn_ratio=</span>Yes<span class="op">/</span>No)</a>
<a class="sourceLine" id="cb57-6" data-line-number="6"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-7" data-line-number="7">p3 &lt;-<span class="st"> </span>tmp[<span class="op">!</span><span class="kw">is.na</span>(tmp<span class="op">$</span>yn_ratio),] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-8" data-line-number="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>prob,<span class="dt">y=</span>yn_ratio,<span class="dt">color=</span>gender))<span class="op">+</span></a>
<a class="sourceLine" id="cb57-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb57-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb57-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb57-12" data-line-number="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;probability of being chosen&quot;</span>,<span class="dt">y=</span><span class="st">&quot;yes-no ratio of decisions&quot;</span>)</a>
<a class="sourceLine" id="cb57-13" data-line-number="13">p4 &lt;-<span class="st"> </span>tmp[<span class="op">!</span><span class="kw">is.na</span>(tmp<span class="op">$</span>yn_ratio),] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>prob,<span class="dt">y=</span>Yes<span class="op">+</span>No,<span class="dt">fill=</span>gender))<span class="op">+</span></a>
<a class="sourceLine" id="cb57-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb57-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb57-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;probability of being chosen&quot;</span>,<span class="dt">y=</span><span class="st">&quot;frequency&quot;</span>)</a>
<a class="sourceLine" id="cb57-18" data-line-number="18">gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(p3,p4,<span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">top=</span><span class="st">&quot;Others&#39; Opinions Influence Decisions&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-2.png" width="960" /></p>
<p>The first graph shows how much do people like their partners. And the second graph shows how likely do people think their partner would like to date with them, namely, say “yes” to them. The graph on the right side is the number of people who gave the score. We use yes-no ratio (the number of people who said “yes” against those who said “no”) to denote the decision of the group. If the ratio is larger than one, means among the people who gave the score, the majority of them want to date with partners.</p>
<p>From the graph, we confirmed that whether or not a person like his/her partner did not have a large influence on his/her decision, namely, they did date with someone they like best. Instead, they tended to choose those who might like them. For females, if they thought a male was 70% likely to say “yes” to themselves, they will also say “yes”. For males, if they thought a female was 80% likely to say “yes” to themselves, they will also say “yes”.</p>

</div>
</div>
<div id="question-will-backrgound-and-common-interests-influence-the-match-which-feature-is-the-most-influential-1" class="section level2">
<h2><span class="header-section-number">7.2</span> Question: Will backrgound and common interests influence the match? Which feature is the most influential?</h2>
<p>To answer this question, we have to look at background and common interests seperately. Background includes three features: <code>race</code>, <code>from</code>, and <code>field</code>. We can do so by comparing the chance of matching by conditioning on whether they are from the same <code>race</code>, same <code>from</code> (location), and same <code>field</code>.</p>
<p>Data Cleaning:</p>
<p>we would like to append 6 indicator columns that indicates whether this person and his/her partner share that feature in common (actually 5 because samerace is available in the original data).</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb58-3" data-line-number="3"><span class="kw">library</span>(vcd)</a>
<a class="sourceLine" id="cb58-4" data-line-number="4"><span class="kw">library</span>(jsonlite)</a></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&#39;data/speed_dating.RData&#39;</span>)</a>
<a class="sourceLine" id="cb59-2" data-line-number="2"></a>
<a class="sourceLine" id="cb59-3" data-line-number="3"><span class="co"># get feature values of the partner</span></a>
<a class="sourceLine" id="cb59-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(speed_dating)) {</a>
<a class="sourceLine" id="cb59-5" data-line-number="5">  <span class="co"># for each row, get partner&#39;s id</span></a>
<a class="sourceLine" id="cb59-6" data-line-number="6">  pid =<span class="st"> </span>speed_dating[i, <span class="st">&#39;pid&#39;</span>]</a>
<a class="sourceLine" id="cb59-7" data-line-number="7">  <span class="co"># add temporary columns that holds partner&#39;s location, field, sports, reading, movies</span></a>
<a class="sourceLine" id="cb59-8" data-line-number="8">  speed_dating[i, <span class="st">&#39;plocation&#39;</span>] =<span class="st"> </span>speed_dating[<span class="kw">which</span>(speed_dating<span class="op">$</span>iid <span class="op">==</span><span class="st"> </span>pid)[<span class="dv">1</span>], <span class="st">&#39;from&#39;</span>]</a>
<a class="sourceLine" id="cb59-9" data-line-number="9">  speed_dating[i, <span class="st">&#39;pfield&#39;</span>] =<span class="st"> </span>speed_dating[<span class="kw">which</span>(speed_dating<span class="op">$</span>iid <span class="op">==</span><span class="st"> </span>pid)[<span class="dv">1</span>], <span class="st">&#39;field&#39;</span>]</a>
<a class="sourceLine" id="cb59-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb59-11" data-line-number="11"><span class="co"># append indicator columns for location, field, and income</span></a>
<a class="sourceLine" id="cb59-12" data-line-number="12">speed_dating[<span class="st">&#39;samelocation&#39;</span>] &lt;-<span class="st"> </span><span class="kw">if_else</span>(speed_dating<span class="op">$</span>from <span class="op">==</span><span class="st"> </span>speed_dating<span class="op">$</span>plocation, <span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>)</a>
<a class="sourceLine" id="cb59-13" data-line-number="13">speed_dating[<span class="st">&#39;samefield&#39;</span>] &lt;-<span class="st"> </span><span class="kw">if_else</span>(speed_dating<span class="op">$</span>field <span class="op">==</span><span class="st"> </span>speed_dating<span class="op">$</span>pfield, <span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>)</a>
<a class="sourceLine" id="cb59-14" data-line-number="14"></a>
<a class="sourceLine" id="cb59-15" data-line-number="15"><span class="co"># get the feature values of all the hobbies of the partner</span></a>
<a class="sourceLine" id="cb59-16" data-line-number="16">f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb59-17" data-line-number="17">  tmp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;holder&quot;</span> =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(speed_dating)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb59-18" data-line-number="18">  result &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;holder&quot;</span> =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(speed_dating)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb59-19" data-line-number="19">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(speed_dating)){</a>
<a class="sourceLine" id="cb59-20" data-line-number="20">    pid =<span class="st"> </span>speed_dating[i, <span class="st">&#39;pid&#39;</span>]</a>
<a class="sourceLine" id="cb59-21" data-line-number="21">    tmp[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>speed_dating[<span class="kw">which</span>(speed_dating<span class="op">$</span>iid <span class="op">==</span><span class="st"> </span>pid)[<span class="dv">1</span>], x]</a>
<a class="sourceLine" id="cb59-22" data-line-number="22">  }</a>
<a class="sourceLine" id="cb59-23" data-line-number="23">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(speed_dating)) {</a>
<a class="sourceLine" id="cb59-24" data-line-number="24">    result[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">if_else</span>((tmp[i,<span class="dv">1</span>] <span class="op">&gt;=</span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>speed_dating[i,x]<span class="op">&gt;=</span><span class="dv">7</span>), <span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>)</a>
<a class="sourceLine" id="cb59-25" data-line-number="25">  }</a>
<a class="sourceLine" id="cb59-26" data-line-number="26">  <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb59-27" data-line-number="27">}</a>
<a class="sourceLine" id="cb59-28" data-line-number="28"><span class="co"># append the newly added columns to the original data frame</span></a>
<a class="sourceLine" id="cb59-29" data-line-number="29">names =<span class="st"> </span><span class="kw">colnames</span>(speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sports<span class="op">:</span>yoga))</a>
<a class="sourceLine" id="cb59-30" data-line-number="30">common_features &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">do.call</span>(cbind,<span class="kw">lapply</span>(names, f)))</a>
<a class="sourceLine" id="cb59-31" data-line-number="31"><span class="kw">colnames</span>(common_features)&lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;same&#39;</span>,<span class="kw">colnames</span>(speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sports<span class="op">:</span>yoga)))</a>
<a class="sourceLine" id="cb59-32" data-line-number="32">speed_dating &lt;-<span class="st"> </span><span class="kw">cbind</span>(speed_dating, common_features)</a>
<a class="sourceLine" id="cb59-33" data-line-number="33">speed_dating &lt;-<span class="st"> </span>speed_dating[, <span class="op">!</span><span class="kw">duplicated</span>(<span class="kw">colnames</span>(speed_dating))]</a>
<a class="sourceLine" id="cb59-34" data-line-number="34"></a>
<a class="sourceLine" id="cb59-35" data-line-number="35"><span class="co"># drop unecessary columns and missing data</span></a>
<a class="sourceLine" id="cb59-36" data-line-number="36">drops =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;plocation&#39;</span>, <span class="st">&#39;pfield&#39;</span>)</a>
<a class="sourceLine" id="cb59-37" data-line-number="37">speed_dating &lt;-<span class="st"> </span><span class="kw">select</span>(speed_dating, <span class="op">-</span>drops)</a>
<a class="sourceLine" id="cb59-38" data-line-number="38">keeps =<span class="st"> </span><span class="kw">append</span>(<span class="kw">paste0</span>(<span class="st">&#39;same&#39;</span>,<span class="kw">colnames</span>(speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sports<span class="op">:</span>yoga))), <span class="kw">c</span>(<span class="st">&#39;samelocation&#39;</span>, <span class="st">&#39;samefield&#39;</span>))</a>
<a class="sourceLine" id="cb59-39" data-line-number="39">speed_dating &lt;-<span class="st"> </span>speed_dating[<span class="kw">complete.cases</span>(speed_dating[,keeps]), ]</a></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="co">#save(speed_dating_q1, file = &quot;data/speed_dating_q1.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;data/speed_dating_q1.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb60-3" data-line-number="3">speed_dating &lt;-<span class="st"> </span>speed_dating_q1</a>
<a class="sourceLine" id="cb60-4" data-line-number="4">names =<span class="st"> </span><span class="kw">colnames</span>(speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sports<span class="op">:</span>yoga))</a></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="co"># for mosaic plot </span></a>
<a class="sourceLine" id="cb61-2" data-line-number="2"></a>
<a class="sourceLine" id="cb61-3" data-line-number="3"><span class="co"># create a clean dataframe for each common feature</span></a>
<a class="sourceLine" id="cb61-4" data-line-number="4">sameracedata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samerace, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">samerace =</span> <span class="kw">if_else</span>(samerace <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb61-5" data-line-number="5">samelocationdata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samelocation, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb61-6" data-line-number="6">samefielddata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samefield, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb61-7" data-line-number="7">samesportsdata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samesports, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb61-8" data-line-number="8">samereadingdata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samereading, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb61-9" data-line-number="9">samemoviesdata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samemovies, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb61-10" data-line-number="10"><span class="kw">cat</span>(</a>
<a class="sourceLine" id="cb61-11" data-line-number="11">  <span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb61-12" data-line-number="12">  <span class="st">&#39;&lt;script&gt;</span></a>
<a class="sourceLine" id="cb61-13" data-line-number="13"><span class="st">    var sameracedata = &#39;</span>,<span class="kw">toJSON</span>(sameracedata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb61-14" data-line-number="14"><span class="st">    var samelocationdata = &#39;</span>,<span class="kw">toJSON</span>(samelocationdata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb61-15" data-line-number="15"><span class="st">    var samefielddata = &#39;</span>,<span class="kw">toJSON</span>(samefielddata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb61-16" data-line-number="16"><span class="st">    var samesportsdata = &#39;</span>,<span class="kw">toJSON</span>(samesportsdata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb61-17" data-line-number="17"><span class="st">    var samereadingdata = &#39;</span>,<span class="kw">toJSON</span>(samereadingdata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb61-18" data-line-number="18"><span class="st">    var samemoviesdata = &#39;</span>,<span class="kw">toJSON</span>(samemoviesdata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb61-19" data-line-number="19"><span class="st">  &lt;/script&gt;&#39;</span></a>
<a class="sourceLine" id="cb61-20" data-line-number="20">  , <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb61-21" data-line-number="21">)</a></code></pre></div>
<script>
    var sameracedata = [{"samerace":"No","match":"No","Freq":3398},{"samerace":"No","match":"Yes","Freq":620},{"samerace":"Yes","match":"No","Freq":2164},{"samerace":"Yes","match":"Yes","Freq":476}];
    var samelocationdata = [{"samelocation":"No","match":"No","Freq":5516},{"samelocation":"No","match":"Yes","Freq":1082},{"samelocation":"Yes","match":"No","Freq":46},{"samelocation":"Yes","match":"Yes","Freq":14}];
    var samefielddata = [{"samefield":"No","match":"No","Freq":5460},{"samefield":"No","match":"Yes","Freq":1054},{"samefield":"Yes","match":"No","Freq":102},{"samefield":"Yes","match":"Yes","Freq":42}];
    var samesportsdata = [{"samesports":"No","match":"No","Freq":4012},{"samesports":"No","match":"Yes","Freq":746},{"samesports":"Yes","match":"No","Freq":1550},{"samesports":"Yes","match":"Yes","Freq":350}];
    var samereadingdata = [{"samereading":"No","match":"No","Freq":2408},{"samereading":"No","match":"Yes","Freq":424},{"samereading":"Yes","match":"No","Freq":3154},{"samereading":"Yes","match":"Yes","Freq":672}];
    var samemoviesdata = [{"samemovies":"No","match":"No","Freq":1570},{"samemovies":"No","match":"Yes","Freq":344},{"samemovies":"Yes","match":"No","Freq":3992},{"samemovies":"Yes","match":"Yes","Freq":752}];
  </script>
<script src="https://d3js.org/d3.v5.min.js"></script>
<svg width="910" height="550">
</svg>
<script>
  //initialize the svg
  var w = 800;
  var h = 500;
  var margin = {top: 25, right: 25, bottom: 25, left: 25};
  var innerWidth = w - margin.left - margin.right;
  var innerHeight = h - margin.top - margin.bottom;
  var dur = 500;
  
  var svg = d3.select("svg");
  svg.append("rect").attr("x", 0).attr("y", 0).attr("width", w).attr("height", h).attr("fill", "aliceblue");
  
  //initialize dataset
  var fill = "lightblue";
  var stroke = "#D0D3D4";
  var textfill = "#797D7F";
  
  var dataset = [{key: "race", value: sameracedata, f:"#2471A3", s:"#4B4C4D", tf: "#4B4C4D", axis: "Same Race", selected: "True", fw: "bold"}
                ,{key: "location", value: samelocationdata, f:fill, s:stroke, tf: textfill, axis: "from Same Location", selected: "False", fw: "normal"}
                ,{key: "field", value: samefielddata, f:fill, s:stroke, tf: textfill, axis: "Work in Same Field", selected: "False", fw: "normal"}
                ,{key: "sports", value: samesportsdata, f:fill, s:stroke, tf: textfill, axis: "Both love Sports", selected: "False", fw: "normal"}
                ,{key: "reading", value: samereadingdata, f:fill, s:stroke, tf: textfill, axis: "Both love Reading", selected: "False", fw: "normal"}
                ,{key: "movie", value: samemoviesdata, f:fill, s:stroke, tf: textfill, axis: "Both love Movies", selected: "False", fw: "normal"}];
  
  // use race feature as the initial plot
  var data = sameracedata;

  //manually transform to a mosaic plot
  function format(data){
    var offset = 50;
    var plotwidth = 350;
    var plotheight = 350;
    var bar2_x = (data[0].Freq+data[1].Freq)/d3.sum(data.map(d => d.Freq))*(plotwidth-5);
    var bar1_y = data[0].Freq/(data[0].Freq+data[1].Freq)*plotheight;
    var bar2_y = data[2].Freq/(data[2].Freq+data[3].Freq)*plotheight;
    return [{x: 2.5* offset, y: 1.5 * offset, w: bar2_x, h:bar1_y, f: "#D0D3D4", lx: bar2_x, t: "No", tx: 2.5 * offset+(bar2_x+5)/2, ty: 1.5 * offset -15},
            {x: 2.5* offset, y:bar1_y+1.5 * offset, w: bar2_x, h:plotheight-bar1_y, f: "#7B7D7D", t: "No", tx: 2.5 * offset-30, ty: bar1_y/2+1.5*offset},
            {x:bar2_x+5+2.5* offset, y:1.5 * offset, w: plotwidth-5-bar2_x, h: bar2_y, f: "#D0D3D4", t: "Yes", tx: 2.5 * offset+(bar2_x+5)+(plotwidth-(bar2_x+5))/2, ty: 1.5 * offset - 15},
            {x:bar2_x+5+2.5* offset, y: bar2_y+1.5 * offset, w:plotwidth-5-bar2_x, h: plotheight - bar2_y, f:"#7B7D7D", t: "Yes", tx:  2.5 * offset-30, ty: (plotheight - bar1_y)/2+bar1_y+1.5 * offset}];
  }
  
  //append the plot to a new group g
  var bars = svg.append("g")
                .attr("id", "plot")
                .attr("transform", `translate (${margin.left}, ${margin.top})`)
              .selectAll("rect")
                .data(format(data));
  
  // plot the initial plot
  bars.enter().append("rect")
      .attr("class", "bar")
      .attr("x", d => d.x)
      .attr("y", d => d.y)  
      .attr("width", d => d.w)
      .attr("height", d => d.h)
      .attr("fill",d => d.f)
      .attr("stroke", "#7B7D7D")
      .attr("stroke-width", "1");
      
  //add labels for axis
  svg.append("text")
      .attr("x", "50")
      .attr("y", "250")
      .attr("font-size","20")
      .attr("text-anchor","middle")
      .attr("font-family","helvetica")
      .attr("fill", "#313132")
      .attr("font-weight","bold")
      .text("Match");
                      
  var xlabel = svg.append("g")
                  .attr("id", "axis")
                  .attr("transform",`translate (${margin.left}, ${margin.top})`)
                .selectAll("text")
                  .data([dataset[0]], d=>d.key).enter()
                  .append("text")
                  .attr("x", "300")
                  .attr("y", "20")
                  .attr("font-size","20")
                  .attr("text-anchor","middle")
                  .attr("font-family","helvetica")
                  .attr("fill", "#313132")
                  .attr("font-weight","bold")
                  .text(d =>d.axis);        
  
  
  // add radio buttons
  var buttons1 = svg.append("g")
                    .attr("id", "buttons1")
                    .attr("class", "radio")
                    .attr("transform",  `translate (${margin.left}, ${margin.top})`)
                  .selectAll("circle")
                    .data(dataset, d=>d.key).enter().append("circle")
                    .attr("cx", "580")
                    .attr("cy", (d,i) => i*50+125)
                    .attr("r", "13")
                    .attr("fill", "aliceblue")
                    .attr("stroke", d=>d.s)
                    .attr("stroke-width", "3")
                    
  var buttons2 = svg.append("g")
                    .attr("id", "buttons2")
                    .attr("class", "radio")
                    .attr("transform",  `translate (${margin.left}, ${margin.top})`)
                  .selectAll("circle")
                    .data(dataset, d=>d.key).enter().append("circle")
                    .attr("cx", "580")
                    .attr("cy", (d,i) => i*50+125)
                    .attr("r", "6")
                    .attr("fill", d => d.f)
                    
  // add "Yes" and "No" text labels
  var labels = svg.select("g#plot").selectAll("text").data(format(data));
  
  labels.enter().append("text")
      .attr("id", "label")
      .attr("x", d=>d.tx)
      .attr("y", d=>d.ty)
      .attr("font-size","18")
      .attr("text-anchor","middle")
      .attr("font-family","helvetica")
      .attr("fill", "#313132")
      .text(d =>d.t); 
                
  //append text next to buttons
  var texts = svg.append("g")
                .attr("id", "texts")
                .attr("class", "radio")
                .attr("transform", `translate (${margin.left}, ${margin.top})`)
              .selectAll("text")
                .data(dataset, d=>d.key).enter().append("text")
                .attr("x", "610")
                .attr("y", (d, i) => i*50+130)
                .attr("fill", d=>d.tf)
                .attr("font-size","20")
                .attr("font-family", "helvetica")
                .attr("font-weight", d=>d.fw)
                .text(d=>d.key);
                    
  //switch event listeners if a button is clicked
  d3.selectAll("g.radio").selectAll("circle").on("click", function(){
    //update the chart
    update(format(d3.select(this).datum().value));
    //change the color of the radio buttons
    dataset.map(d => d.f = fill);
    dataset.map(d => d.s = stroke);
    dataset.map(d => d.tf = textfill);
    dataset.map(d => d.selected = "False");
    d3.select(this).datum().f = "#2471A3";
    d3.select(this).datum().s = "#4B4C4D";
    d3.select(this).datum().tf = "#4B4C4D";
    d3.select(this).datum().selected = "True";
    updatebutton(dataset);
    //change axis label
    xlabel.data([d3.select(this).datum()]).text(d=>d.axis);
  });
      
  // update method (using general update pattern)
  function update(data){
    var bars = svg.select("#plot").selectAll("rect").data(data);
    bars.transition().duration(dur)
        .ease(d3.easeLinear)
        .attr("x", d => d.x)
        .attr("y", d => d.y)  
        .attr("width", d => d.w)
        .attr("height", d => d.h);
    var labels = svg.selectAll("text#label").data(data);
    labels.transition().duration(dur)
        .ease(d3.easeLinear)
        .attr("x", d => d.tx)
        .attr("y", d => d.ty) 
  }
  
  // update method(for radio buttons)
  function updatebutton(dataset){
    buttons1.data(dataset).attr("stroke", d => d.s);
    buttons2.data(dataset).attr("fill", d=> d.f);
    texts.data(dataset).attr("fill", d=>d.tf).attr("font-weight", d=>d.fw);
  }
  
  d3.selectAll("g.radio").selectAll("circle").on("mouseover", handleMouseOver).on("mouseout", handleMouseOut);
  
  function handleMouseOver(){
    if(d3.select(this).datum().selected == "False"){
      d3.select(this).datum().f = "#4a9bd4";
      d3.select(this).datum().s = "#969696";
      d3.select(this).datum().tf = "#969696";
      d3.select(this).datum().fw = "bold";
      updatebutton(dataset);
    }
  }
  
  function handleMouseOut(){
    if(d3.select(this).datum().selected == "False"){
      d3.select(this).datum().f = fill;
      d3.select(this).datum().s = stroke;
      d3.select(this).datum().tf = textfill;
      d3.select(this).datum().fw = "normal";
      updatebutton(dataset);
    }
  }
</script>
<p>We then look at all the available features that could be of common interest in the dataset, and see if any of those features heavily impacts the chances of getting matched.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">calc_diff &lt;-<span class="st"> </span><span class="cf">function</span>(y){</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">  tmp &lt;-<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by_</span>(y, <span class="st">&#39;match&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb62-3" data-line-number="3">  no_rate &lt;-<span class="st"> </span>tmp[<span class="dv">2</span>,<span class="dv">3</span>]<span class="op">/</span>(tmp[<span class="dv">2</span>,<span class="dv">3</span>]<span class="op">+</span>tmp[<span class="dv">1</span>,<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb62-4" data-line-number="4">  yes_rate &lt;-<span class="st"> </span>tmp[<span class="dv">4</span>,<span class="dv">3</span>]<span class="op">/</span>(tmp[<span class="dv">3</span>,<span class="dv">3</span>]<span class="op">+</span>tmp[<span class="dv">4</span>,<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb62-5" data-line-number="5">  hobby &lt;-<span class="st"> </span><span class="kw">substring</span>(<span class="kw">as.character</span>(y), <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb62-6" data-line-number="6">  result &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;hobby&quot;</span> =<span class="st"> </span><span class="kw">c</span>(hobby,hobby), <span class="st">&quot;share_hobby&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>), <span class="st">&quot;Freq&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb62-7" data-line-number="7">  result[<span class="dv">1</span>,<span class="dv">3</span>] &lt;-yes_rate<span class="op">*</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb62-8" data-line-number="8">  result[<span class="dv">2</span>,<span class="dv">3</span>] &lt;-no_rate<span class="op">*</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb62-9" data-line-number="9">  <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb62-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb62-11" data-line-number="11">cd_df &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind,<span class="kw">lapply</span>(<span class="kw">paste0</span>(<span class="st">&#39;same&#39;</span>,<span class="kw">colnames</span>(speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sports<span class="op">:</span>yoga))),calc_diff))</a>
<a class="sourceLine" id="cb62-12" data-line-number="12"><span class="kw">ggplot</span>(cd_df,<span class="kw">aes</span>(<span class="dt">x=</span>Freq,<span class="dt">y=</span><span class="kw">fct_reorder2</span>(hobby, share_hobby <span class="op">==</span><span class="st"> &#39;Yes&#39;</span>,Freq, <span class="dt">.desc=</span><span class="ot">FALSE</span>), <span class="dt">color =</span> <span class="kw">fct_rev</span>(share_hobby)))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Hobbies&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Percent (%)&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;Chances of Matching&quot;</span>)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">color=</span><span class="st">&quot;Participants Share this Hobby&quot;</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),</a>
<a class="sourceLine" id="cb62-13" data-line-number="13">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),</a>
<a class="sourceLine" id="cb62-14" data-line-number="14">        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb62-15" data-line-number="15">        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>), </a>
<a class="sourceLine" id="cb62-16" data-line-number="16">           <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>

</div>
<div id="question-do-people-with-excess-self-esteem-get-more-romantic-interest-1" class="section level2">
<h2><span class="header-section-number">7.3</span> Question: do people with excess self-esteem get more romantic interest?</h2>
<p>Self-enhancement is one kind of motivation that makes people feel good and boost their confidence (<a href="https://en.wikipedia.org/wiki/Self-enhancement" class="uri">https://en.wikipedia.org/wiki/Self-enhancement</a>). Epley and Whitchurch’s work is one evidence supporting the idea that people tend to see themselves better that the reality (<a href="https://journals.sagepub.com/doi/abs/10.1177/0146167208318601?journalCode=pspc" class="uri">https://journals.sagepub.com/doi/abs/10.1177/0146167208318601?journalCode=pspc</a>). The phenomenon is also known as “illusory superiority”, where the majority of people evaluates themself as better than the average.</p>
<p>It is widely believed that confident people preform better in various tasks including in relationships (see <a href="https://www.psychologytoday.com/us/blog/shyness-is-nice/201809/why-self-confidence-is-more-important-you-think">Link</a>). This section of the analysis focuses on this idea. Specifically, we want to know if <em>confident people get more interests during the Speed Dating session</em>.</p>
<p>Given the dataset, we define confidence, or excess self-esteem, as how much higher a subject evaluates itself than other people rate the subject (<code>peer score</code>). That is, the varaible excess self-esteem is calculated by subtracting an averaged evaluation score given by others from the score given to self. A large positive difference indicates highly excess self-esteem. A large negative difference suggests very low self-esteem. The variable is called <code>self-esteem</code> in the analysis and <code>peer score</code> is an average score a subject received from other people.</p>
<div class="figure">
<img src="data/3_self_esteem.jpg" alt="http://images.lipy.com/women-vs-men" />
<p class="caption"><a href="http://images.lipy.com/women-vs-men" class="uri">http://images.lipy.com/women-vs-men</a></p>
</div>
<p>One distinct characteristics of participants is gender. However, the previous question found no difference between genders. Moreover, this characteristics does not distinquish subjects in terms of their excess self-esteem. Below are distribution of score difference for each gender in each attribute. Their distribution are similar, peaking at around 1 with almost identical spread.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">attr_list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;amb&quot;</span>=<span class="st">&quot;Ambitious&quot;</span>, <span class="st">&quot;attr&quot;</span>=<span class="st">&quot;Attractive&quot;</span>, <span class="st">&quot;fun&quot;</span>=<span class="st">&quot;Fun&quot;</span>, <span class="st">&quot;intel&quot;</span>=<span class="st">&quot;Intelligent&quot;</span>, <span class="st">&quot;sinc&quot;</span>=<span class="st">&quot;Sincere&quot;</span>)</a>
<a class="sourceLine" id="cb63-2" data-line-number="2"><span class="kw">ggplot</span>(eval_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">ifelse</span>(gender <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>),</a>
<a class="sourceLine" id="cb63-3" data-line-number="3">                          <span class="dt">gender =</span> <span class="kw">as.factor</span>(gender),</a>
<a class="sourceLine" id="cb63-4" data-line-number="4">                          <span class="dt">attr =</span> attr_list[attr]), <span class="kw">aes</span>(<span class="dt">x=</span>diff_before, <span class="dt">fill =</span> gender)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Histogram of Evaluation Ratio&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-7" data-line-number="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Ratio&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-8" data-line-number="8"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>attr)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>When <code>self-esteem</code> is plotted against the proportion of people who want to meet with a subject again, referred to as <code>interest proportion</code>, the only small difference between gender is that female participants tend to get higher interest proportion than male participants. This is shown by more red dots locating at the top and more blue dots at the bottom of the graph. However, dots at the top and the bottom constitute only a small number of participants. Therefore, this analysis treat both genders collectively.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="co">## color by gender</span></a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="kw">ggplot</span>(diff_df, <span class="kw">aes</span>(<span class="dt">x=</span>diff_before, <span class="dt">y =</span> proportion, <span class="dt">color =</span> gender)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>attr) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Self Esteem&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-6" data-line-number="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Interest Proportion&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="1152" /></p>
<p>The plots above also suggest that people with excess self-esteem generally have low interest proportion. The correlation is stronger in fun and attractive, with the most negative correlation in attractive. That is, a participant with lower self-esteem in his/her own attractive and fun tend to get more romatic interest from the others.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">cor_list &lt;-<span class="st"> </span><span class="kw">lapply</span>(eval_df<span class="op">$</span>attr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unique</span>(), <span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb65-2" data-line-number="2">  attr_eval_df &lt;-<span class="st"> </span>eval_df<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(attr <span class="op">==</span><span class="st"> </span>a) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(diff_before, proportion)</a>
<a class="sourceLine" id="cb65-3" data-line-number="3">  c &lt;-<span class="st"> </span><span class="kw">cor</span>(attr_eval_df<span class="op">$</span>diff_before, attr_eval_df<span class="op">$</span>proportion)</a>
<a class="sourceLine" id="cb65-4" data-line-number="4">  <span class="kw">return</span>(<span class="kw">data.frame</span>(<span class="st">&quot;Attribute&quot;</span>=a, <span class="st">&quot;Correlation&quot;</span> =<span class="st"> </span>c))</a>
<a class="sourceLine" id="cb65-5" data-line-number="5">})</a>
<a class="sourceLine" id="cb65-6" data-line-number="6"></a>
<a class="sourceLine" id="cb65-7" data-line-number="7">attr_list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;attr&quot;</span>=<span class="st">&quot;Attractive&quot;</span>, <span class="st">&quot;sinc&quot;</span>=<span class="st">&quot;Sincere&quot;</span>, <span class="st">&quot;amb&quot;</span>=<span class="st">&quot;Ambitious&quot;</span>, <span class="st">&quot;fun&quot;</span>=<span class="st">&quot;Fun&quot;</span>, <span class="st">&quot;intel&quot;</span>=<span class="st">&quot;Intelligent&quot;</span>)</a>
<a class="sourceLine" id="cb65-8" data-line-number="8">cor_df &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, cor_list) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Attribute =</span> attr_list[Attribute])</a>
<a class="sourceLine" id="cb65-9" data-line-number="9">cor_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>()</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Attribute
</th>
<th style="text-align:right;">
Correlation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Attractive
</td>
<td style="text-align:right;">
-0.1857069
</td>
</tr>
<tr>
<td style="text-align:left;">
Sincere
</td>
<td style="text-align:right;">
-0.4475117
</td>
</tr>
<tr>
<td style="text-align:left;">
Ambitious
</td>
<td style="text-align:right;">
-0.2780918
</td>
</tr>
<tr>
<td style="text-align:left;">
Fun
</td>
<td style="text-align:right;">
-0.3056818
</td>
</tr>
<tr>
<td style="text-align:left;">
Intelligent
</td>
<td style="text-align:right;">
-0.1804723
</td>
</tr>
</tbody>
</table>
<p>The fact that attractive has the strongest correlation with interest proportion should not be surprising since it is the attribute that people look for the most in their partner (discussed in previous question). The next part narrows its focus down to attractive attribute only.</p>
<p>Below is a plot of <code>peer score</code> against <code>interest proportion</code>. Data points are colored by <code>self esteem</code>. Darker color indicates a person with lower self-esteem.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="kw">ggplot</span>(diff_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(attr <span class="op">==</span><span class="st"> &quot;attr&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="st">         </span><span class="kw">rename</span>(<span class="dt">self_esteem =</span> diff_before), </a>
<a class="sourceLine" id="cb66-3" data-line-number="3">       <span class="kw">aes</span>(<span class="dt">x=</span>peer_score , <span class="dt">y =</span>  proportion, <span class="dt">color =</span> self_esteem)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Peer Score&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-6" data-line-number="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Interest Proportion&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>The plot shows a linear relationship between peer evaluation score and interest proportion. A person who, othter people think, is attractive gain more romantic interest proportion, especially when average score is below 5. The linear relationship becomes weaker for those with score larger than 6.</p>
<p>We also found that people who are less confident in their attractiveness tend to get more interests. This is shown by darker dots at the top right of the plot. Poeple with low self esteem gain more proportion of interest.</p>
<p>Before jumping into a conclusion that being attractive is what matters, we inspect other characteristics of subjects. We are curious whether there are some confounding varaibles (other than what has been explored in the previous questions) that get a subject more romantic interest. All the graphs below are relationships between <code>peer score</code> on attractive and <code>interest proportion</code>. Dots are colored by other characterisitcs that we want to inspect.</p>
<div id="race-1" class="section level4">
<h4><span class="header-section-number">7.3.0.1</span> Race</h4>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">race_list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Black/African American&quot;</span>, <span class="st">&quot;European/Caucasian-American&quot;</span>, <span class="st">&quot;Latino/Hispanic American&quot;</span>,</a>
<a class="sourceLine" id="cb67-2" data-line-number="2">               <span class="st">&quot;Asian/Pacific Islander/Asian-American&quot;</span>, <span class="st">&quot;Native American&quot;</span>, <span class="st">&quot;Other&quot;</span>)</a>
<a class="sourceLine" id="cb67-3" data-line-number="3"></a>
<a class="sourceLine" id="cb67-4" data-line-number="4"></a>
<a class="sourceLine" id="cb67-5" data-line-number="5">pl1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diff_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(attr <span class="op">==</span><span class="st"> &quot;attr&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-6" data-line-number="6"><span class="st">         </span><span class="kw">select</span>(iid, race) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-7" data-line-number="7"><span class="st">         </span><span class="kw">group_by</span>(race) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-8" data-line-number="8"><span class="st">         </span><span class="kw">summarize</span>(<span class="dt">cnt =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-9" data-line-number="9"><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">race =</span> race_list[race]), <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">fct_reorder</span>(race, cnt), <span class="dt">y =</span> cnt, <span class="dt">fill =</span> race)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-11" data-line-number="11"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-12" data-line-number="12"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;count&quot;</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb67-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb67-14" data-line-number="14"></a>
<a class="sourceLine" id="cb67-15" data-line-number="15">pl2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diff_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(attr <span class="op">==</span><span class="st"> &quot;attr&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-16" data-line-number="16"><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">race =</span> race_list[race]), </a>
<a class="sourceLine" id="cb67-17" data-line-number="17">         <span class="kw">aes</span>(<span class="dt">x=</span>peer_score, <span class="dt">y =</span> proportion, <span class="dt">color =</span> race)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb67-19" data-line-number="19"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Peer Score for Attractive&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-20" data-line-number="20"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Interest Proportion&quot;</span>)  </a>
<a class="sourceLine" id="cb67-21" data-line-number="21"></a>
<a class="sourceLine" id="cb67-22" data-line-number="22"><span class="kw">ggplotly</span>(pl1, <span class="dt">tooltip =</span> <span class="kw">c</span>(<span class="st">&quot;cnt&quot;</span>))</a></code></pre></div>
<div id="htmlwidget-a36836169344b9310bae" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a36836169344b9310bae">{"x":{"data":[{"orientation":"h","width":0.9,"base":0,"x":[98],"y":[4],"text":"cnt:  98","type":"bar","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Asian/Pacific Islander/Asian-American","legendgroup":"Asian/Pacific Islander/Asian-American","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[17],"y":[1],"text":"cnt:  17","type":"bar","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Black/African American","legendgroup":"Black/African American","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[210],"y":[5],"text":"cnt: 210","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"European/Caucasian-American","legendgroup":"European/Caucasian-American","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[34],"y":[3],"text":"cnt:  34","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Latino/Hispanic American","legendgroup":"Latino/Hispanic American","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[30],"y":[2],"text":"cnt:  30","type":"bar","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Native American","legendgroup":"Native American","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":227.214611872146},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-10.5,220.5],"tickmode":"array","ticktext":["0","50","100","150","200"],"tickvals":[0,50,100,150,200],"categoryorder":"array","categoryarray":["0","50","100","150","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,5.6],"tickmode":"array","ticktext":["Black/African American","Native American","Latino/Hispanic American","Asian/Pacific Islander/Asian-American","European/Caucasian-American"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["Black/African American","Native American","Latino/Hispanic American","Asian/Pacific Islander/Asian-American","European/Caucasian-American"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"c187153c756c":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"c187153c756c","visdat":{"c187153c756c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw">ggplotly</span>(pl2, <span class="dt">tooltip =</span> <span class="kw">c</span>(<span class="st">&quot;race&quot;</span>))</a></code></pre></div>
<div id="htmlwidget-7729baaea9624e87155a" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7729baaea9624e87155a">{"x":{"data":[{"x":[6.7,6.8,4.8,5.0625,5.9375,6.93333333333333,7.1875,4.10526315789474,3.68421052631579,4.94736842105263,6.31578947368421,4.4,5.3,6.38888888888889,5.88888888888889,3.66666666666667,4,5.83333333333333,6.375,3.77777777777778,7.33333333333333,5.55555555555556,6.77777777777778,6.66666666666667,4,3.85714285714286,5.71428571428571,6.57142857142857,5.61904761904762,5.28571428571429,5.95238095238095,6.14285714285714,5.1,4.35,6.09523809523809,5.09523809523809,7.85714285714286,5.78571428571429,6.57142857142857,6.92857142857143,7.21428571428571,5.07142857142857,7.39285714285714,7.77777777777778,7.55555555555556,5.1,7.3,7.0625,4.70588235294118,6.88235294117647,7.58823529411765,5.10526315789474,5.64705882352941,5.55555555555556,5.29411764705882,5.11111111111111,5.77777777777778,6.75,6.875,6,6.14285714285714,5.78571428571429,7.1,2.8,4.2,5.5,7.5,5.66666666666667,6.16666666666667,4.16666666666667,5.83333333333333,7,8,8.06666666666667,6.26666666666667,5.93333333333333,4.28571428571429,3.66666666666667,4.93333333333333,7.28571428571429,7,3.83333333333333,4.66666666666667,6,5.83333333333333,5.3,6.09523809523809,7.23809523809524,4.09090909090909,7,4.09523809523809,4.14285714285714,4.45454545454545,6,4.5,5.04761904761905,5.15,4.9],"y":[0.5,0.5,0.4,0.1875,0.375,0.5625,0.6875,0.210526315789474,0,0.210526315789474,0.421052631578947,0.1,0.2,0.277777777777778,0.166666666666667,0.166666666666667,0,0.444444444444444,0.4,0,0.7,0.111111111111111,0.666666666666667,0.888888888888889,0,0.238095238095238,0.333333333333333,0.761904761904762,0.476190476190476,0.428571428571429,0.238095238095238,0.571428571428571,0.142857142857143,0,0.571428571428571,0.238095238095238,0.642857142857143,0.357142857142857,0.214285714285714,0.142857142857143,0.642857142857143,0.0714285714285714,0.571428571428571,0.555555555555556,0.555555555555556,0.4,0.5,0.388888888888889,0.0555555555555556,0.333333333333333,0.611111111111111,0.25,0.3,0.15,0.263157894736842,0.111111111111111,0.333333333333333,0.625,0.5,0.666666666666667,0.642857142857143,0.5,0.3,0,0.1,0.166666666666667,1,0.166666666666667,0.333333333333333,0.166666666666667,0.5,0.666666666666667,0.733333333333333,0.733333333333333,0.466666666666667,0.0666666666666667,0.133333333333333,0.0666666666666667,0.266666666666667,0.6,0.857142857142857,0,0,0.666666666666667,0.166666666666667,0.454545454545455,0.181818181818182,0.545454545454545,0.0909090909090909,0.636363636363636,0.136363636363636,0.136363636363636,0.318181818181818,0.545454545454545,0.272727272727273,0.272727272727273,0.272727272727273,0.363636363636364],"text":"race: Asian/Pacific Islander/Asian-American","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Asian/Pacific Islander/Asian-American","legendgroup":"Asian/Pacific Islander/Asian-American","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.8,6.53333333333333,6.31578947368421,6.21052631578947,5.5,6.27777777777778,5,5.85714285714286,6.47619047619048,7.33333333333333,4.88888888888889,5.38888888888889,5.64285714285714,7.93333333333333,4.26666666666667,5.85714285714286,6.14285714285714],"y":[0.1875,0.4375,0.578947368421053,0.315789473684211,0.2,0.555555555555556,0.2,0.666666666666667,0.380952380952381,0.380952380952381,0.222222222222222,0.277777777777778,0.285714285714286,0.8,0.133333333333333,0.857142857142857,0.454545454545455],"text":"race: Black/African American","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"hoveron":"points","name":"Black/African American","legendgroup":"Black/African American","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.7,7,5.3,6.33333333333333,5.6,8.2,5.6,6.7,5.1,6.5,7.6875,5.75,6.0625,7.875,6,7.3125,6.25,4.93333333333333,4.26315789473684,4.89473684210526,5.21052631578947,7.63157894736842,4.05263157894737,6.73684210526316,5.36842105263158,3.83333333333333,6.88888888888889,4.42105263157895,7.5,5.3,3.9,7.3,6,5,6.4,6.11111111111111,5.3,6.22222222222222,6.83333333333333,7.88888888888889,6.38888888888889,7.33333333333333,7.5,7,6.94444444444444,7.88888888888889,7.13888888888889,4.66666666666667,7.16666666666667,5.61111111111111,7.83333333333333,4.11111111111111,6.22222222222222,6.94117647058824,6.88888888888889,7.16666666666667,5.5,6.4,7.22222222222222,6.7,7.77777777777778,4.8,8,6.11111111111111,7.33333333333333,7.55555555555556,6.22222222222222,7.88888888888889,5.33333333333333,6.66666666666667,5.77777777777778,5.66666666666667,6.33333333333333,4.77777777777778,4.11111111111111,6.85714285714286,6.55,5.38095238095238,6.09523809523809,5,7.35714285714286,7.47619047619048,6.52380952380952,7.57142857142857,5.85714285714286,6.28571428571429,5.80952380952381,6.52380952380952,4.47619047619048,7.02380952380952,5.52380952380952,5.80952380952381,4.80952380952381,6,6.57142857142857,5.57142857142857,5.21428571428571,7.21428571428571,5.78571428571429,5.64285714285714,6.14285714285714,5.07142857142857,7.21428571428571,6.42857142857143,6.64285714285714,6.78571428571429,7,7.53846153846154,7.92857142857143,4.42857142857143,5.5,7.11111111111111,8.33333333333333,7.33333333333333,5,7.8,6.22222222222222,5.9,5.25,6,8.17647058823529,6.83333333333333,7.23529411764706,7.98888888888889,6.21875,4.16666666666667,5.52631578947368,7,7.52631578947368,6.55555555555556,6.4,7.94117647058824,7.3,6.64705882352941,8.31578947368421,6.55555555555556,6.38888888888889,6.22222222222222,6.33333333333333,7,5.63157894736842,8.18421052631579,6.97368421052632,7.61111111111111,6.52631578947368,6,5.11111111111111,5.44444444444444,5.68421052631579,5.72222222222222,7.11111111111111,6.33333333333333,4.88888888888889,8.30555555555556,7.11111111111111,6.83333333333333,7.02777777777778,5.72222222222222,6.88888888888889,3.9375,5.25,7.5,6.5,6.16666666666667,6.83333333333333,6.57142857142857,7.14285714285714,7.28571428571429,5.92857142857143,6.5,8.4,6.6,6.1,8.4,6.5,7.9,5.6,5.83333333333333,7.73333333333333,8.33333333333333,7.85714285714286,6.4,5.4,5.86666666666667,7.46666666666667,3.69230769230769,5.73333333333333,5.71428571428571,6.71428571428571,2.33333333333333,6.5,7.94117647058824,4.66666666666667,7,7.04545454545455,6.13636363636364,6.40909090909091,4.52380952380952,5.71428571428571,6,6.6,5.65,5,4.2,6,7.38095238095238,6.85714285714286,6.35,5.13636363636364,7.3],"y":[0.6,0.6,0.3,0.4,0.4,0.8,0.3,0.8,0.3,0.5,0.875,0.1875,0.25,0.8125,0.25,0.6875,0.5,0.1875,0.157894736842105,0.210526315789474,0.210526315789474,0.473684210526316,0.0526315789473684,0.421052631578947,0.263157894736842,0.210526315789474,0.473684210526316,0,0.7,0.2,0.2,0.7,0.3,0.4,0.2,0.4,0.3,0.5,0.444444444444444,0.777777777777778,0.388888888888889,0.777777777777778,0.555555555555556,0.333333333333333,0.444444444444444,0.611111111111111,0.777777777777778,0.111111111111111,0.555555555555556,0.111111111111111,0.944444444444444,0.111111111111111,0.277777777777778,0.5,0.666666666666667,0.555555555555556,0.277777777777778,0.4,0.5,0.6,0.5,0.2,0.8,0.3,0.5,0.7,0.3,0.888888888888889,0.333333333333333,0.555555555555556,0.333333333333333,0.777777777777778,0.666666666666667,0.333333333333333,0.111111111111111,0.523809523809524,0.333333333333333,0.428571428571429,0.619047619047619,0.333333333333333,0.80952380952381,0.761904761904762,0.476190476190476,0.523809523809524,0.333333333333333,0.0476190476190476,0.333333333333333,0.571428571428571,0,0.571428571428571,0.19047619047619,0.333333333333333,0,0.476190476190476,0.333333333333333,0.142857142857143,0.357142857142857,0.571428571428571,0.214285714285714,0.214285714285714,0.285714285714286,0,0.571428571428571,0.285714285714286,0.5,0.5,0.642857142857143,0.642857142857143,0.642857142857143,0.214285714285714,0,0.444444444444444,0.888888888888889,0.555555555555556,0.333333333333333,0.8,0.6,0.4,0.166666666666667,0.333333333333333,0.666666666666667,0.5,0.611111111111111,0.222222222222222,0.277777777777778,0.2,0.45,0.5,0.9,0.6,0.5,0.7,0.5,0.5,0.55,0.35,0.421052631578947,0.421052631578947,0.578947368421053,0.684210526315789,0.315789473684211,0.736842105263158,0.473684210526316,0.894736842105263,0.526315789473684,0.473684210526316,0.315789473684211,0.263157894736842,0.263157894736842,0.333333333333333,0.666666666666667,0.5,0.166666666666667,0.611111111111111,0.722222222222222,0.611111111111111,0.5,0.333333333333333,0.611111111111111,0.0555555555555556,0.125,0.875,0.833333333333333,0.333333333333333,0.5,0.5,0.785714285714286,0.5,0.285714285714286,0.714285714285714,0.5,0.5,0.4,0.5,0.4,0.6,0.3,0.5,0.666666666666667,0.666666666666667,0.533333333333333,0.133333333333333,0.6,0.333333333333333,0.733333333333333,0.133333333333333,0.466666666666667,0.428571428571429,0.571428571428571,0,0.333333333333333,0.409090909090909,0.181818181818182,0.409090909090909,0.636363636363636,0.5,0.545454545454545,0,0.318181818181818,0.681818181818182,0.454545454545455,0.545454545454545,0.363636363636364,0.227272727272727,0.318181818181818,0.545454545454545,0.454545454545455,0.454545454545455,0.272727272727273,0.681818181818182],"text":"race: European/Caucasian-American","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"hoveron":"points","name":"European/Caucasian-American","legendgroup":"European/Caucasian-American","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.7,8.1875,4.33333333333333,8.3,5.44444444444444,6.47222222222222,7.33333333333333,6.77777777777778,4.38888888888889,5.11111111111111,7.9,7.8,8,6.83333333333333,8.5,5.61904761904762,5.61904761904762,6.22222222222222,6.1,5.9375,6.88888888888889,6.4,8.52941176470588,6.72222222222222,6.3,7.2,7.06666666666667,6.33333333333333,5.53333333333333,7.66666666666667,7.65,5.88235294117647,4.55,5.45],"y":[0.3,0.9375,0.125,0.8,0.3,0.277777777777778,0.722222222222222,0.5,0,0.277777777777778,0.8,0.7,0.777777777777778,0.523809523809524,0.952380952380952,0.285714285714286,0.285714285714286,0.333333333333333,0.4,0.166666666666667,0.388888888888889,0.45,0.65,0.5,0.2,0.466666666666667,0.533333333333333,0.266666666666667,0.4,0.8,0.636363636363636,0.272727272727273,0.136363636363636,0.227272727272727],"text":"race: Latino/Hispanic American","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"hoveron":"points","name":"Latino/Hispanic American","legendgroup":"Latino/Hispanic American","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7,6.5,6.55555555555556,5.22222222222222,6.61111111111111,8.38888888888889,4.55555555555556,7.9,7.77777777777778,5.88888888888889,7,4.22222222222222,6.77777777777778,4.77777777777778,6.90476190476191,4.57142857142857,5.57142857142857,4.8,5.88888888888889,6.0625,6.35294117647059,5.14285714285714,7.7,4.5,8.33333333333333,7.33333333333333,4.8,4.95238095238095,4.90476190476191,5.45454545454545],"y":[0.7,0.4,0.4,0.2,0.555555555555556,0.888888888888889,0.277777777777778,0.8,0.7,0.444444444444444,0.777777777777778,0,0.888888888888889,0.222222222222222,0.666666666666667,0.0952380952380952,0.0714285714285714,0.3,0.222222222222222,0.222222222222222,0.55,0.428571428571429,0.3,0.166666666666667,0.666666666666667,0.666666666666667,0.2,0.181818181818182,0.136363636363636,0.318181818181818],"text":"race: Native American","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"hoveron":"points","name":"Native American","legendgroup":"Native American","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.02352941176471,8.83921568627451],"tickmode":"array","ticktext":["4","6","8"],"tickvals":[4,6,8],"categoryorder":"array","categoryarray":["4","6","8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Peer Score for Attractive","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Interest Proportion","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"annotations":[{"text":"race","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"c1871f63e9ba":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"c1871f63e9ba","visdat":{"c1871f63e9ba":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="co">#subplot(ggplotly(pl1, tooltip = c(&quot;cnt&quot;)), ggplotly(pl2, tooltip = c(&quot;race&quot;)),nrows=1)</span></a></code></pre></div>
<p>We find no pattern among <code>proportion</code>, <code>peer_score</code>, and <code>race</code>.</p>
</div>
<div id="field-of-study-1" class="section level4">
<h4><span class="header-section-number">7.3.0.2</span> Field of Study</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">field_list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Law&quot;</span>, <span class="st">&quot;Math&quot;</span>, <span class="st">&quot;Social Science&quot;</span>, <span class="st">&quot;Psychologist&quot;</span>, <span class="st">&quot;Medical Science&quot;</span>, <span class="st">&quot;Pharmaceuticals and Bio Tech&quot;</span>,</a>
<a class="sourceLine" id="cb70-2" data-line-number="2">                <span class="st">&quot;Engineering&quot;</span>, <span class="st">&quot;English/Creative Writing/ Journalism&quot;</span>, <span class="st">&quot;History/Religion/Philosophy&quot;</span>,</a>
<a class="sourceLine" id="cb70-3" data-line-number="3">                <span class="st">&quot;Business/Econ/Finance&quot;</span>, <span class="st">&quot;Education, Academia&quot;</span>, <span class="st">&quot;Biological Sciences/Chemistry/Physics&quot;</span>,</a>
<a class="sourceLine" id="cb70-4" data-line-number="4">                <span class="st">&quot;Social Work&quot;</span>, <span class="st">&quot;Undergrad/undecided&quot;</span>, <span class="st">&quot;Political Science/International Affairs&quot;</span>, <span class="st">&quot;Film&quot;</span>,</a>
<a class="sourceLine" id="cb70-5" data-line-number="5">                <span class="st">&quot;Fine Arts/Arts Administration&quot;</span>, <span class="st">&quot;Languages&quot;</span>, <span class="st">&quot;Architecture&quot;</span>, <span class="st">&quot;Other&quot;</span>)</a>
<a class="sourceLine" id="cb70-6" data-line-number="6"></a>
<a class="sourceLine" id="cb70-7" data-line-number="7">pl1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diff_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(attr <span class="op">==</span><span class="st"> &quot;attr&quot;</span>, <span class="op">!</span><span class="kw">is.na</span>(field_cd)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-8" data-line-number="8"><span class="st">         </span><span class="kw">select</span>(iid, field_cd) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-9" data-line-number="9"><span class="st">         </span><span class="kw">group_by</span>(field_cd) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-10" data-line-number="10"><span class="st">         </span><span class="kw">summarize</span>(<span class="dt">cnt =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-11" data-line-number="11"><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">field_cd =</span> field_list[field_cd]), </a>
<a class="sourceLine" id="cb70-12" data-line-number="12">         <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">fct_reorder</span>(field_cd, cnt), <span class="dt">y =</span> cnt, <span class="dt">fill =</span> field_cd)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-14" data-line-number="14"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-15" data-line-number="15"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;count&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb70-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb70-17" data-line-number="17"></a>
<a class="sourceLine" id="cb70-18" data-line-number="18"><span class="co">## field X</span></a>
<a class="sourceLine" id="cb70-19" data-line-number="19">pl2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diff_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-20" data-line-number="20"><span class="st">                </span><span class="kw">filter</span>(attr <span class="op">==</span><span class="st"> &quot;attr&quot;</span>, <span class="op">!</span><span class="kw">is.na</span>(field_cd)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-21" data-line-number="21"><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">field_cd =</span> field_list[field_cd]), </a>
<a class="sourceLine" id="cb70-22" data-line-number="22">         <span class="kw">aes</span>(<span class="dt">x=</span>peer_score, <span class="dt">y =</span> proportion, <span class="dt">color =</span> field_cd)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb70-24" data-line-number="24"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Attractive Peer Score&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-25" data-line-number="25"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Interest Proportion&quot;</span>)</a>
<a class="sourceLine" id="cb70-26" data-line-number="26"></a>
<a class="sourceLine" id="cb70-27" data-line-number="27"><span class="kw">ggplotly</span>(pl1, <span class="dt">tooltip =</span> <span class="kw">c</span>(<span class="st">&quot;cnt&quot;</span>))</a></code></pre></div>
<div id="htmlwidget-351e303ad84ac2e66015" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-351e303ad84ac2e66015">{"x":{"data":[{"orientation":"h","width":0.9,"base":0,"x":[1],"y":[1],"text":"cnt:  1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Biological Sciences/Chemistry/Physics","legendgroup":"Biological Sciences/Chemistry/Physics","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[36],"y":[14],"text":"cnt: 36","type":"bar","marker":{"autocolorscale":false,"color":"rgba(232,133,38,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Business/Econ/Finance","legendgroup":"Business/Econ/Finance","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[27],"y":[12],"text":"cnt: 27","type":"bar","marker":{"autocolorscale":false,"color":"rgba(211,146,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Education, Academia","legendgroup":"Education, Academia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[8],"y":[7],"text":"cnt:  8","type":"bar","marker":{"autocolorscale":false,"color":"rgba(183,159,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Engineering","legendgroup":"Engineering","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[79],"y":[18],"text":"cnt: 79","type":"bar","marker":{"autocolorscale":false,"color":"rgba(147,170,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"English/Creative Writing/ Journalism","legendgroup":"English/Creative Writing/ Journalism","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[3],"y":[3],"text":"cnt:  3","type":"bar","marker":{"autocolorscale":false,"color":"rgba(94,179,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Film","legendgroup":"Film","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[1],"y":[2],"text":"cnt:  1","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Fine Arts/Arts Administration","legendgroup":"Fine Arts/Arts Administration","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[32],"y":[13],"text":"cnt: 32","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,116,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"History/Religion/Philosophy","legendgroup":"History/Religion/Philosophy","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[3],"y":[4],"text":"cnt:  3","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,193,159,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Languages","legendgroup":"Languages","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[42],"y":[16],"text":"cnt: 42","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Law","legendgroup":"Law","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[8],"y":[8],"text":"cnt:  8","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,185,227,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Math","legendgroup":"Math","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[46],"y":[17],"text":"cnt: 46","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,173,250,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Medical Science","legendgroup":"Medical Science","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[18],"y":[10],"text":"cnt: 18","type":"bar","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Pharmaceuticals and Bio Tech","legendgroup":"Pharmaceuticals and Bio Tech","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[10],"y":[9],"text":"cnt: 10","type":"bar","marker":{"autocolorscale":false,"color":"rgba(174,135,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Political Science/International Affairs","legendgroup":"Political Science/International Affairs","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[7],"y":[6],"text":"cnt:  7","type":"bar","marker":{"autocolorscale":false,"color":"rgba(219,114,251,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Psychologist","legendgroup":"Psychologist","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[38],"y":[15],"text":"cnt: 38","type":"bar","marker":{"autocolorscale":false,"color":"rgba(245,100,227,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Social Science","legendgroup":"Social Science","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.899999999999999,"base":0,"x":[23],"y":[11],"text":"cnt: 23","type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,97,195,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Social Work","legendgroup":"Social Work","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[6],"y":[5],"text":"cnt:  6","type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,105,156,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Undergrad/undecided","legendgroup":"Undergrad/undecided","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":238.904109589041},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.95,82.95],"tickmode":"array","ticktext":["0","20","40","60","80"],"tickvals":[0,20,40,60,80],"categoryorder":"array","categoryarray":["0","20","40","60","80"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,18.6],"tickmode":"array","ticktext":["Biological Sciences/Chemistry/Physics","Fine Arts/Arts Administration","Film","Languages","Undergrad/undecided","Psychologist","Engineering","Math","Political Science/International Affairs","Pharmaceuticals and Bio Tech","Social Work","Education, Academia","History/Religion/Philosophy","Business/Econ/Finance","Social Science","Law","Medical Science","English/Creative Writing/ Journalism"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"categoryorder":"array","categoryarray":["Biological Sciences/Chemistry/Physics","Fine Arts/Arts Administration","Film","Languages","Undergrad/undecided","Psychologist","Engineering","Math","Political Science/International Affairs","Pharmaceuticals and Bio Tech","Social Work","Education, Academia","History/Religion/Philosophy","Business/Econ/Finance","Social Science","Law","Medical Science","English/Creative Writing/ Journalism"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"c1874840bcb0":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"c1874840bcb0","visdat":{"c1874840bcb0":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">ggplotly</span>(pl2, <span class="dt">tooltip =</span> <span class="kw">c</span>(<span class="st">&quot;field_cd&quot;</span>))</a></code></pre></div>
<div id="htmlwidget-5ff0ecaf6972f10db9be" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5ff0ecaf6972f10db9be">{"x":{"data":[{"x":[6.73684210526316],"y":[0.421052631578947],"text":"field_cd: Biological Sciences/Chemistry/Physics","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Biological Sciences/Chemistry/Physics","legendgroup":"Biological Sciences/Chemistry/Physics","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.38888888888889,6.77777777777778,5.88888888888889,7.16666666666667,4.11111111111111,6.94117647058824,5.55555555555556,5.77777777777778,4.11111111111111,4,5.71428571428571,6.55,5.61904761904762,5.28571428571429,5.95238095238095,6.14285714285714,5.85714285714286,5.80952380952381,6.52380952380952,7.02380952380952,6.57142857142857,5.09523809523809,5.25,6,5.5,5.83333333333333,5.93333333333333,7.93333333333333,5.53333333333333,7.33333333333333,5.71428571428571,5.85714285714286,6.71428571428571,2.33333333333333,7.23809523809524,6],"y":[0.277777777777778,0.5,0.166666666666667,0.555555555555556,0.111111111111111,0.5,0.111111111111111,0.333333333333333,0.111111111111111,0,0.333333333333333,0.333333333333333,0.476190476190476,0.428571428571429,0.238095238095238,0.571428571428571,0.333333333333333,0.333333333333333,0.571428571428571,0.571428571428571,0.333333333333333,0.238095238095238,0.166666666666667,0.333333333333333,0.166666666666667,0.5,0.0666666666666667,0.8,0.4,0.666666666666667,0.428571428571429,0.857142857142857,0.571428571428571,0,0.545454545454545,0.681818181818182],"text":"field_cd: Business/Econ/Finance","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(232,133,38,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(232,133,38,1)"}},"hoveron":"points","name":"Business/Econ/Finance","legendgroup":"Business/Econ/Finance","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.5,7.6875,5.75,7.5,5.3,5.3,6.5,6.83333333333333,6.47222222222222,6.38888888888889,7.5,7,5.61111111111111,6.52380952380952,7.57142857142857,5.78571428571429,7.5,6.875,6.57142857142857,7.14285714285714,5.92857142857143,6.5,4.95238095238095,6.13636363636364,4.55,4.90476190476191,5.45],"y":[0.5,0.875,0.1875,0.7,0.2,0.2,0.4,0.444444444444444,0.277777777777778,0.388888888888889,0.555555555555556,0.333333333333333,0.111111111111111,0.476190476190476,0.523809523809524,0.357142857142857,0.875,0.5,0.5,0.785714285714286,0.285714285714286,0.714285714285714,0.181818181818182,0.5,0.136363636363636,0.136363636363636,0.227272727272727],"text":"field_cd: Education, Academia","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(211,146,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(211,146,0,1)"}},"hoveron":"points","name":"Education, Academia","legendgroup":"Education, Academia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.9,6.88888888888889,6.11111111111111,5.33333333333333,4.77777777777778,4.77777777777778,7.47619047619048,5.5],"y":[0.2,0.666666666666667,0.3,0.333333333333333,0.333333333333333,0.222222222222222,0.761904761904762,0],"text":"field_cd: Engineering","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(183,159,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(183,159,0,1)"}},"hoveron":"points","name":"Engineering","legendgroup":"Engineering","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.6,5.6,5.1,7.1875,4.26315789473684,5.21052631578947,7.63157894736842,4.05263157894737,6.31578947368421,4.42105263157895,5.44444444444444,7.3,6,6.11111111111111,7.33333333333333,6.94444444444444,3.66666666666667,4.66666666666667,4.55555555555556,4,6.22222222222222,6.4,5,7.77777777777778,3.77777777777778,6.22222222222222,6.77777777777778,6.66666666666667,6.33333333333333,7,4.22222222222222,5.80952380952381,6.09523809523809,5.61904761904762,7.39285714285714,7,7.53846153846154,7.92857142857143,7.8,7.3,6.4,7,7.52631578947368,7.94117647058824,7.3,6.64705882352941,8.52941176470588,5.64705882352941,8.31578947368421,5.55555555555556,6.55555555555556,7.11111111111111,6.33333333333333,5.77777777777778,7.02777777777778,5.72222222222222,6.88888888888889,3.9375,6.5,6.16666666666667,6,6.83333333333333,8.4,2.8,4.2,7.5,6.16666666666667,7,8.33333333333333,5.4,4.93333333333333,7.46666666666667,7.66666666666667,7.65,7.38095238095238,6.85714285714286,6.35,5.13636363636364,6.14285714285714],"y":[0.4,0.3,0.3,0.6875,0.157894736842105,0.210526315789474,0.473684210526316,0.0526315789473684,0.421052631578947,0,0.3,0.7,0.3,0.4,0.722222222222222,0.444444444444444,0.166666666666667,0.111111111111111,0.277777777777778,0,0.277777777777778,0.4,0.2,0.5,0,0.3,0.666666666666667,0.888888888888889,0.666666666666667,0.777777777777778,0,0.333333333333333,0.571428571428571,0.285714285714286,0.571428571428571,0.642857142857143,0.642857142857143,0.642857142857143,0.8,0.5,0.45,0.5,0.9,0.7,0.5,0.5,0.65,0.3,0.55,0.15,0.35,0.666666666666667,0.5,0.333333333333333,0.5,0.333333333333333,0.611111111111111,0.0555555555555556,0.833333333333333,0.333333333333333,0.666666666666667,0.5,0.5,0,0.1,1,0.333333333333333,0.666666666666667,0.666666666666667,0.6,0.266666666666667,0.733333333333333,0.8,0.636363636363636,0.545454545454545,0.454545454545455,0.454545454545455,0.272727272727273,0.454545454545455],"text":"field_cd: English/Creative Writing/ Journalism","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(147,170,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(147,170,0,1)"}},"hoveron":"points","name":"English/Creative Writing/ Journalism","legendgroup":"English/Creative Writing/ Journalism","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.9,5.66666666666667,7.35714285714286],"y":[0.8,0.777777777777778,0.80952380952381],"text":"field_cd: Film","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(94,179,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(94,179,0,1)"}},"hoveron":"points","name":"Film","legendgroup":"Film","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.1],"y":[0.4],"text":"field_cd: Fine Arts/Arts Administration","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"Fine Arts/Arts Administration","legendgroup":"Fine Arts/Arts Administration","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.8,6.61111111111111,7.88888888888889,7.88888888888889,6.85714285714286,6.90476190476191,7.85714285714286,5.57142857142857,5.21428571428571,7.21428571428571,6.14285714285714,7.21428571428571,6.57142857142857,6.92857142857143,7.21428571428571,5.07142857142857,6.64285714285714,4.42857142857143,4.88888888888889,7.33333333333333,5,5.9375,4.70588235294118,6.88235294117647,5.88888888888889,7.58823529411765,6.33333333333333,7,6.14285714285714,5.78571428571429,6.4,4.09090909090909],"y":[0.1875,0.555555555555556,0.611111111111111,0.888888888888889,0.523809523809524,0.666666666666667,0.642857142857143,0.142857142857143,0.357142857142857,0.571428571428571,0.285714285714286,0.571428571428571,0.214285714285714,0.142857142857143,0.642857142857143,0.0714285714285714,0.5,0.214285714285714,0.222222222222222,0.555555555555556,0.333333333333333,0.166666666666667,0.0555555555555556,0.333333333333333,0.222222222222222,0.611111111111111,0.578947368421053,0.684210526315789,0.642857142857143,0.5,0.133333333333333,0.0909090909090909],"text":"field_cd: History/Religion/Philosophy","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,116,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,116,1)"}},"hoveron":"points","name":"History/Religion/Philosophy","legendgroup":"History/Religion/Philosophy","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.73333333333333,4.28571428571429,7.3],"y":[0.666666666666667,0.133333333333333,0.681818181818182],"text":"field_cd: Languages","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,193,159,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,193,159,1)"}},"hoveron":"points","name":"Languages","legendgroup":"Languages","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.7,7.7,7,5.3,6.8,4.8,8.2,5.7,6.0625,7.875,6.53333333333333,4.33333333333333,3.68421052631579,6.31578947368421,5.36842105263158,3.83333333333333,6.21052631578947,8.3,4.4,6.55555555555556,5,5.22222222222222,8.38888888888889,7.83333333333333,6.27777777777778,5.11111111111111,7.77777777777778,5,4.16666666666667,5.52631578947368,7.61111111111111,5.72222222222222,6.75,5.64285714285714,7.28571428571429,8.4,6.6,6.1,7.9,7.7,6.40909090909091,5],"y":[0.5,0.6,0.6,0.3,0.5,0.4,0.8,0.3,0.25,0.8125,0.4375,0.125,0,0.578947368421053,0.263157894736842,0.210526315789474,0.315789473684211,0.8,0.1,0.4,0.4,0.2,0.888888888888889,0.944444444444444,0.555555555555556,0.277777777777778,0.7,0.333333333333333,0.2,0.45,0.894736842105263,0.333333333333333,0.625,0.285714285714286,0.5,0.5,0.5,0.4,0.6,0.3,0.545454545454545,0.363636363636364],"text":"field_cd: Law","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Law","legendgroup":"Law","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.3125,6.25,4.80952380952381,5.11111111111111,4.66666666666667,6,5.83333333333333,6.6],"y":[0.6875,0.5,0,0.111111111111111,0,0.666666666666667,0.166666666666667,0.454545454545455],"text":"field_cd: Math","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,185,227,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,185,227,1)"}},"hoveron":"points","name":"Math","legendgroup":"Math","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.0625,4.94736842105263,6.4,5.3,7.13888888888889,4.38888888888889,7.16666666666667,6.375,7.33333333333333,7.55555555555556,7.33333333333333,6.28571428571429,4.47619047619048,6.47619047619048,5.1,4.57142857142857,7.77777777777778,7.55555555555556,5.9,4.8,5.10526315789474,4.88888888888889,8.30555555555556,6.83333333333333,4.5,4.16666666666667,7.2,6.33333333333333,7.85714285714286,7,3.83333333333333,6.5,6.09523809523809,4.09523809523809,4.14285714285714,4.45454545454545,5.71428571428571,5.45454545454545,6,5.65,4.2,4.5,5.04761904761905,5.15,4.9,6],"y":[0.1875,0.210526315789474,0.2,0.3,0.777777777777778,0,0.555555555555556,0.4,0.5,0.7,0.7,0.0476190476190476,0,0.380952380952381,0.142857142857143,0.0952380952380952,0.555555555555556,0.555555555555556,0.4,0.3,0.25,0.166666666666667,0.611111111111111,0.611111111111111,0.166666666666667,0.166666666666667,0.466666666666667,0.266666666666667,0.533333333333333,0.857142857142857,0,0.333333333333333,0.181818181818182,0.136363636363636,0.136363636363636,0.318181818181818,0.318181818181818,0.318181818181818,0.545454545454545,0.545454545454545,0.227272727272727,0.272727272727273,0.272727272727273,0.272727272727273,0.363636363636364,0.318181818181818],"text":"field_cd: Medical Science","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,173,250,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,173,250,1)"}},"hoveron":"points","name":"Medical Science","legendgroup":"Medical Science","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.5,6.22222222222222,7.88888888888889,7.8,6.77777777777778,6.09523809523809,5.78571428571429,6.21875,6.52631578947368,6,5.11111111111111,5.44444444444444,5.68421052631579,5.66666666666667,3.66666666666667,5.73333333333333,5.3,7],"y":[0.2,0.5,0.777777777777778,0.7,0.888888888888889,0.619047619047619,0.214285714285714,0.277777777777778,0.526315789473684,0.473684210526316,0.315789473684211,0.263157894736842,0.263157894736842,0.166666666666667,0.0666666666666667,0.466666666666667,0.454545454545455,0.409090909090909],"text":"field_cd: Pharmaceuticals and Bio Tech","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"Pharmaceuticals and Bio Tech","legendgroup":"Pharmaceuticals and Bio Tech","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.66666666666667,6.78571428571429,5.29411764705882,5.14285714285714,5.83333333333333,4.8,7.94117647058824,5.88235294117647,7.04545454545455,4.52380952380952],"y":[0.555555555555556,0.5,0.263157894736842,0.428571428571429,0.5,0.2,0.409090909090909,0.272727272727273,0.636363636363636,0],"text":"field_cd: Political Science/International Affairs","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(174,135,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(174,135,255,1)"}},"hoveron":"points","name":"Political Science/International Affairs","legendgroup":"Political Science/International Affairs","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.88888888888889,8,6.57142857142857,8.5,8.06666666666667,6.26666666666667,7],"y":[0.473684210526316,0.8,0.761904761904762,0.952380952380952,0.733333333333333,0.466666666666667,0.636363636363636],"text":"field_cd: Psychologist","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(219,114,251,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(219,114,251,1)"}},"hoveron":"points","name":"Psychologist","legendgroup":"Psychologist","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.9375,8.1875,6.93333333333333,6,4.93333333333333,4.89473684210526,7.33333333333333,7.9,7.22222222222222,4.8,5.88888888888889,8,3.85714285714286,5.38095238095238,5.85714285714286,5.61904761904762,5.52380952380952,6,5.64285714285714,5.07142857142857,6.42857142857143,7.11111111111111,6.22222222222222,5.1,6.22222222222222,8.17647058823529,6.83333333333333,7.23529411764706,7.98888888888889,6.0625,6.4,5.63157894736842,8.18421052631579,6.97368421052632,5.25,5.86666666666667,4.26666666666667,4.66666666666667],"y":[0.375,0.9375,0.5625,0.25,0.1875,0.210526315789474,0.777777777777778,0.8,0.5,0.2,0.444444444444444,0.777777777777778,0.238095238095238,0.428571428571429,0.666666666666667,0.285714285714286,0.19047619047619,0.476190476190476,0.214285714285714,0,0.285714285714286,0.444444444444444,0.333333333333333,0.4,0.6,0.666666666666667,0.5,0.611111111111111,0.222222222222222,0.222222222222222,0.5,0.315789473684211,0.736842105263158,0.473684210526316,0.125,0.333333333333333,0.133333333333333,0.181818181818182],"text":"field_cd: Social Science","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(245,100,227,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(245,100,227,1)"}},"hoveron":"points","name":"Social Science","legendgroup":"Social Science","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7,6.33333333333333,6.7,6.7,6.83333333333333,4.35,7.33333333333333,5.57142857142857,8.33333333333333,7.0625,6.88888888888889,6.55555555555556,6.35294117647059,5.38888888888889,6.72222222222222,6.3,6.5,7.1,5.6,8.33333333333333,8,7.06666666666667,7.28571428571429],"y":[0.7,0.4,0.8,0.6,0.523809523809524,0,0.380952380952381,0.0714285714285714,0.888888888888889,0.388888888888889,0.388888888888889,0.6,0.55,0.277777777777778,0.5,0.2,0.4,0.3,0.3,0.666666666666667,0.733333333333333,0.533333333333333,0.6],"text":"field_cd: Social Work","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,97,195,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,97,195,1)"}},"hoveron":"points","name":"Social Work","legendgroup":"Social Work","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.83333333333333,5.5,6.38888888888889,6.22222222222222,7.11111111111111,3.69230769230769],"y":[0.444444444444444,0.277777777777778,0.421052631578947,0.421052631578947,0.722222222222222,0.133333333333333],"text":"field_cd: Undergrad/undecided","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,105,156,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,105,156,1)"}},"hoveron":"points","name":"Undergrad/undecided","legendgroup":"Undergrad/undecided","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.02352941176471,8.83921568627451],"tickmode":"array","ticktext":["4","6","8"],"tickvals":[4,6,8],"categoryorder":"array","categoryarray":["4","6","8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Attractive Peer Score","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Interest Proportion","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"annotations":[{"text":"field_cd","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"c187560e6cd3":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"c187560e6cd3","visdat":{"c187560e6cd3":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="co">#subplot(ggplotly(pl1, tooltip = c(&quot;cnt&quot;)), ggplotly(pl2, tooltip = c(&quot;field_cd&quot;)), nrows=1)</span></a></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">fc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/field_cat.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cd =</span> <span class="kw">row_number</span>())</a>
<a class="sourceLine" id="cb73-3" data-line-number="3">cat_list &lt;-<span class="st"> </span>fc<span class="op">$</span>cat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()</a>
<a class="sourceLine" id="cb73-4" data-line-number="4"><span class="kw">names</span>(cat_list) &lt;-<span class="st"> </span>fc<span class="op">$</span>cd</a>
<a class="sourceLine" id="cb73-5" data-line-number="5"></a>
<a class="sourceLine" id="cb73-6" data-line-number="6">diff_df &lt;-<span class="st"> </span>diff_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">field_cate_cd =</span> cat_list[field_cd]) </a></code></pre></div>
<p>In addition to considering individual majors, we create major categories to see any general pattern that involves in school majors.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">pl1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diff_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(attr <span class="op">==</span><span class="st"> &quot;attr&quot;</span>, <span class="op">!</span><span class="kw">is.na</span>(field_cate_cd)) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="st">         </span><span class="kw">select</span>(iid, field_cate_cd)<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-3" data-line-number="3"><span class="st">         </span><span class="kw">group_by</span>(field_cate_cd) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-4" data-line-number="4"><span class="st">         </span><span class="kw">summarize</span>(<span class="dt">cnt =</span> <span class="kw">n</span>()), </a>
<a class="sourceLine" id="cb74-5" data-line-number="5">         <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">fct_reorder</span>(field_cate_cd, cnt), <span class="dt">y =</span> cnt, <span class="dt">fill =</span> field_cate_cd)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-7" data-line-number="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-8" data-line-number="8"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;count&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb74-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb74-10" data-line-number="10"></a>
<a class="sourceLine" id="cb74-11" data-line-number="11">pl2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diff_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(attr <span class="op">==</span><span class="st"> &quot;attr&quot;</span>, <span class="op">!</span><span class="kw">is.na</span>(field_cate_cd)), </a>
<a class="sourceLine" id="cb74-12" data-line-number="12">       <span class="kw">aes</span>(<span class="dt">x=</span>peer_score, <span class="dt">y =</span> proportion, <span class="dt">color =</span> field_cate_cd)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb74-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-15" data-line-number="15"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Attractive Peer Score&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-16" data-line-number="16"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Interest Proportion&quot;</span>)</a>
<a class="sourceLine" id="cb74-17" data-line-number="17"></a>
<a class="sourceLine" id="cb74-18" data-line-number="18"><span class="kw">ggplotly</span>(pl1, <span class="dt">tooltip =</span> <span class="kw">c</span>(<span class="st">&quot;cnt&quot;</span>))</a></code></pre></div>
<div id="htmlwidget-e886afd43cbe940649c5" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e886afd43cbe940649c5">{"x":{"data":[{"orientation":"h","width":0.9,"base":0,"x":[37],"y":[3],"text":"cnt:  37","type":"bar","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Arts and Humanities","legendgroup":"Arts and Humanities","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[79],"y":[5],"text":"cnt:  79","type":"bar","marker":{"autocolorscale":false,"color":"rgba(196,154,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Business","legendgroup":"Business","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[7],"y":[2],"text":"cnt:   7","type":"bar","marker":{"autocolorscale":false,"color":"rgba(83,180,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Health and Medicine","legendgroup":"Health and Medicine","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[4],"y":[1],"text":"cnt:   4","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,192,148,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Other","legendgroup":"Other","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[65],"y":[4],"text":"cnt:  65","type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,182,235,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Public and Social Services","legendgroup":"Public and Social Services","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[91],"y":[6],"text":"cnt:  91","type":"bar","marker":{"autocolorscale":false,"color":"rgba(165,138,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Science, Math, and Technology","legendgroup":"Science, Math, and Technology","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"h","width":0.9,"base":0,"x":[105],"y":[7],"text":"cnt: 105","type":"bar","marker":{"autocolorscale":false,"color":"rgba(251,97,215,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Social Sciences","legendgroup":"Social Sciences","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":180.456621004566},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5.25,110.25],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,7.6],"tickmode":"array","ticktext":["Other","Health and Medicine","Arts and Humanities","Public and Social Services","Business","Science, Math, and Technology","Social Sciences"],"tickvals":[1,2,3,4,5,6,7],"categoryorder":"array","categoryarray":["Other","Health and Medicine","Arts and Humanities","Public and Social Services","Business","Science, Math, and Technology","Social Sciences"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"c187115a2edc":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"c187115a2edc","visdat":{"c187115a2edc":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw">ggplotly</span>(pl2, <span class="dt">tooltip =</span> <span class="kw">c</span>(<span class="st">&quot;field_cate_cd&quot;</span>))</a></code></pre></div>
<div id="htmlwidget-3749f5f40f2a2957515e" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-3749f5f40f2a2957515e">{"x":{"data":[{"x":[5.5,6.22222222222222,7.88888888888889,5.83333333333333,5.5,7.9,7.8,6.66666666666667,5.66666666666667,6.77777777777778,6.09523809523809,7.35714285714286,5.78571428571429,6.78571428571429,6.21875,6.38888888888889,6.22222222222222,6.52631578947368,6,5.11111111111111,5.44444444444444,5.68421052631579,5.29411764705882,7.11111111111111,5.14285714285714,5.83333333333333,5.66666666666667,3.66666666666667,3.69230769230769,5.73333333333333,4.8,5.3,7.94117647058824,7,5.88235294117647,7.04545454545455,4.52380952380952],"y":[0.2,0.5,0.777777777777778,0.444444444444444,0.277777777777778,0.8,0.7,0.555555555555556,0.777777777777778,0.888888888888889,0.619047619047619,0.80952380952381,0.214285714285714,0.5,0.277777777777778,0.421052631578947,0.421052631578947,0.526315789473684,0.473684210526316,0.315789473684211,0.263157894736842,0.263157894736842,0.263157894736842,0.722222222222222,0.428571428571429,0.5,0.166666666666667,0.0666666666666667,0.133333333333333,0.466666666666667,0.2,0.454545454545455,0.409090909090909,0.409090909090909,0.272727272727273,0.636363636363636,0],"text":"field_cate_cd: Arts and Humanities","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Arts and Humanities","legendgroup":"Arts and Humanities","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.6,5.6,5.1,7.1875,4.26315789473684,5.21052631578947,7.63157894736842,4.05263157894737,6.31578947368421,4.42105263157895,5.44444444444444,7.3,6,6.11111111111111,7.33333333333333,6.94444444444444,3.66666666666667,4.66666666666667,4.55555555555556,4,6.22222222222222,6.4,5,7.77777777777778,3.77777777777778,6.22222222222222,6.77777777777778,6.66666666666667,6.33333333333333,7,4.22222222222222,5.80952380952381,6.09523809523809,5.61904761904762,7.39285714285714,7,7.53846153846154,7.92857142857143,7.8,7.3,6.4,7,7.52631578947368,7.94117647058824,7.3,6.64705882352941,8.52941176470588,5.64705882352941,8.31578947368421,5.55555555555556,6.55555555555556,7.11111111111111,6.33333333333333,5.77777777777778,7.02777777777778,5.72222222222222,6.88888888888889,3.9375,6.5,6.16666666666667,6,6.83333333333333,8.4,2.8,4.2,7.5,6.16666666666667,7,8.33333333333333,5.4,4.93333333333333,7.46666666666667,7.66666666666667,7.65,7.38095238095238,6.85714285714286,6.35,5.13636363636364,6.14285714285714],"y":[0.4,0.3,0.3,0.6875,0.157894736842105,0.210526315789474,0.473684210526316,0.0526315789473684,0.421052631578947,0,0.3,0.7,0.3,0.4,0.722222222222222,0.444444444444444,0.166666666666667,0.111111111111111,0.277777777777778,0,0.277777777777778,0.4,0.2,0.5,0,0.3,0.666666666666667,0.888888888888889,0.666666666666667,0.777777777777778,0,0.333333333333333,0.571428571428571,0.285714285714286,0.571428571428571,0.642857142857143,0.642857142857143,0.642857142857143,0.8,0.5,0.45,0.5,0.9,0.7,0.5,0.5,0.65,0.3,0.55,0.15,0.35,0.666666666666667,0.5,0.333333333333333,0.5,0.333333333333333,0.611111111111111,0.0555555555555556,0.833333333333333,0.333333333333333,0.666666666666667,0.5,0.5,0,0.1,1,0.333333333333333,0.666666666666667,0.666666666666667,0.6,0.266666666666667,0.733333333333333,0.8,0.636363636363636,0.545454545454545,0.454545454545455,0.454545454545455,0.272727272727273,0.454545454545455],"text":"field_cate_cd: Business","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(196,154,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(196,154,0,1)"}},"hoveron":"points","name":"Business","legendgroup":"Business","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.88888888888889,8,6.57142857142857,8.5,8.06666666666667,6.26666666666667,7],"y":[0.473684210526316,0.8,0.761904761904762,0.952380952380952,0.733333333333333,0.466666666666667,0.636363636363636],"text":"field_cate_cd: Health and Medicine","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(83,180,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(83,180,0,1)"}},"hoveron":"points","name":"Health and Medicine","legendgroup":"Health and Medicine","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.73684210526316,7.73333333333333,4.28571428571429,7.3],"y":[0.421052631578947,0.666666666666667,0.133333333333333,0.681818181818182],"text":"field_cate_cd: Other","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,192,148,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,192,148,1)"}},"hoveron":"points","name":"Other","legendgroup":"Other","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.7,7.7,7,5.3,6.8,7,6.33333333333333,4.8,8.2,5.7,6.7,6.0625,7.875,6.53333333333333,4.33333333333333,3.68421052631579,6.31578947368421,5.36842105263158,3.83333333333333,6.21052631578947,8.3,4.4,6.55555555555556,5,5.22222222222222,8.38888888888889,7.83333333333333,6.27777777777778,5.11111111111111,6.7,7.77777777777778,6.83333333333333,5,4.35,7.33333333333333,5.57142857142857,8.33333333333333,7.0625,6.88888888888889,4.16666666666667,5.52631578947368,6.55555555555556,6.35294117647059,7.61111111111111,5.72222222222222,5.38888888888889,6.72222222222222,6.75,5.64285714285714,7.28571428571429,8.4,6.6,6.1,6.3,6.5,7.1,7.9,7.7,5.6,8.33333333333333,8,7.06666666666667,7.28571428571429,6.40909090909091,5],"y":[0.5,0.6,0.6,0.3,0.5,0.7,0.4,0.4,0.8,0.3,0.8,0.25,0.8125,0.4375,0.125,0,0.578947368421053,0.263157894736842,0.210526315789474,0.315789473684211,0.8,0.1,0.4,0.4,0.2,0.888888888888889,0.944444444444444,0.555555555555556,0.277777777777778,0.6,0.7,0.523809523809524,0.333333333333333,0,0.380952380952381,0.0714285714285714,0.888888888888889,0.388888888888889,0.388888888888889,0.2,0.45,0.6,0.55,0.894736842105263,0.333333333333333,0.277777777777778,0.5,0.625,0.285714285714286,0.5,0.5,0.5,0.4,0.2,0.4,0.3,0.6,0.3,0.3,0.666666666666667,0.733333333333333,0.533333333333333,0.6,0.545454545454545,0.363636363636364],"text":"field_cate_cd: Public and Social Services","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,182,235,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,182,235,1)"}},"hoveron":"points","name":"Public and Social Services","legendgroup":"Public and Social Services","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.0625,7.3125,6.25,4.94736842105263,6.4,5.3,6.38888888888889,6.77777777777778,5.88888888888889,7.13888888888889,4.38888888888889,7.16666666666667,4.11111111111111,6.94117647058824,7.16666666666667,6.375,7.33333333333333,7.55555555555556,7.33333333333333,5.55555555555556,5.77777777777778,4.11111111111111,4,5.71428571428571,6.55,5.61904761904762,5.28571428571429,5.95238095238095,6.14285714285714,5.85714285714286,6.28571428571429,5.80952380952381,6.52380952380952,4.47619047619048,7.02380952380952,6.47619047619048,5.1,4.57142857142857,4.80952380952381,6.57142857142857,5.09523809523809,7.77777777777778,7.55555555555556,6.1,5.9,4.8,5.25,6,5.10526315789474,5.11111111111111,4.88888888888889,8.30555555555556,6.83333333333333,5.5,4.5,4.16666666666667,5.83333333333333,7.2,5.93333333333333,7.93333333333333,6.33333333333333,7.85714285714286,5.53333333333333,7.33333333333333,7,5.71428571428571,5.85714285714286,6.71428571428571,3.83333333333333,2.33333333333333,6.5,4.66666666666667,6,5.83333333333333,6.09523809523809,7.23809523809524,4.09523809523809,4.14285714285714,4.45454545454545,5.71428571428571,5.45454545454545,6,6.6,6,5.65,4.2,4.5,5.04761904761905,5.15,4.9,6],"y":[0.1875,0.6875,0.5,0.210526315789474,0.2,0.3,0.277777777777778,0.5,0.166666666666667,0.777777777777778,0,0.555555555555556,0.111111111111111,0.5,0.555555555555556,0.4,0.5,0.7,0.7,0.111111111111111,0.333333333333333,0.111111111111111,0,0.333333333333333,0.333333333333333,0.476190476190476,0.428571428571429,0.238095238095238,0.571428571428571,0.333333333333333,0.0476190476190476,0.333333333333333,0.571428571428571,0,0.571428571428571,0.380952380952381,0.142857142857143,0.0952380952380952,0,0.333333333333333,0.238095238095238,0.555555555555556,0.555555555555556,0.4,0.4,0.3,0.166666666666667,0.333333333333333,0.25,0.111111111111111,0.166666666666667,0.611111111111111,0.611111111111111,0.166666666666667,0.166666666666667,0.166666666666667,0.5,0.466666666666667,0.0666666666666667,0.8,0.266666666666667,0.533333333333333,0.4,0.666666666666667,0.857142857142857,0.428571428571429,0.857142857142857,0.571428571428571,0,0,0.333333333333333,0,0.666666666666667,0.166666666666667,0.181818181818182,0.545454545454545,0.136363636363636,0.136363636363636,0.318181818181818,0.318181818181818,0.318181818181818,0.681818181818182,0.454545454545455,0.545454545454545,0.545454545454545,0.227272727272727,0.272727272727273,0.272727272727273,0.272727272727273,0.363636363636364,0.318181818181818],"text":"field_cate_cd: Science, Math, and Technology","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(165,138,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(165,138,255,1)"}},"hoveron":"points","name":"Science, Math, and Technology","legendgroup":"Science, Math, and Technology","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.8,5.9375,6.5,7.6875,8.1875,5.75,6.93333333333333,6,4.93333333333333,4.89473684210526,7.5,5.3,3.9,5.3,6.5,6.83333333333333,6.47222222222222,6.61111111111111,6.38888888888889,7.33333333333333,7.5,7,7.88888888888889,5.61111111111111,6.88888888888889,7.9,7.22222222222222,4.8,6.11111111111111,5.88888888888889,7.88888888888889,5.33333333333333,8,4.77777777777778,4.77777777777778,3.85714285714286,6.85714285714286,6.90476190476191,5.38095238095238,5.85714285714286,7.47619047619048,6.52380952380952,7.57142857142857,5.61904761904762,5.52380952380952,6,7.85714285714286,5.57142857142857,5.21428571428571,7.21428571428571,5.78571428571429,5.64285714285714,6.14285714285714,5.07142857142857,7.21428571428571,6.42857142857143,6.57142857142857,6.92857142857143,7.21428571428571,5.07142857142857,6.64285714285714,4.42857142857143,5.5,7.11111111111111,6.22222222222222,4.88888888888889,7.33333333333333,5,5.1,6.22222222222222,5.9375,4.70588235294118,8.17647058823529,6.88235294117647,5.88888888888889,6.83333333333333,7.23529411764706,7.98888888888889,7.58823529411765,6.0625,6.4,6.33333333333333,7,5.63157894736842,8.18421052631579,6.97368421052632,5.25,7.5,6.875,6.14285714285714,5.78571428571429,6.57142857142857,7.14285714285714,5.92857142857143,6.5,6.4,5.86666666666667,4.26666666666667,4.66666666666667,4.95238095238095,6.13636363636364,4.09090909090909,4.55,4.90476190476191,5.45],"y":[0.1875,0.375,0.5,0.875,0.9375,0.1875,0.5625,0.25,0.1875,0.210526315789474,0.7,0.2,0.2,0.2,0.4,0.444444444444444,0.277777777777778,0.555555555555556,0.388888888888889,0.777777777777778,0.555555555555556,0.333333333333333,0.611111111111111,0.111111111111111,0.666666666666667,0.8,0.5,0.2,0.3,0.444444444444444,0.888888888888889,0.333333333333333,0.777777777777778,0.333333333333333,0.222222222222222,0.238095238095238,0.523809523809524,0.666666666666667,0.428571428571429,0.666666666666667,0.761904761904762,0.476190476190476,0.523809523809524,0.285714285714286,0.19047619047619,0.476190476190476,0.642857142857143,0.142857142857143,0.357142857142857,0.571428571428571,0.357142857142857,0.214285714285714,0.285714285714286,0,0.571428571428571,0.285714285714286,0.214285714285714,0.142857142857143,0.642857142857143,0.0714285714285714,0.5,0.214285714285714,0,0.444444444444444,0.333333333333333,0.222222222222222,0.555555555555556,0.333333333333333,0.4,0.6,0.166666666666667,0.0555555555555556,0.666666666666667,0.333333333333333,0.222222222222222,0.5,0.611111111111111,0.222222222222222,0.611111111111111,0.222222222222222,0.5,0.578947368421053,0.684210526315789,0.315789473684211,0.736842105263158,0.473684210526316,0.125,0.875,0.5,0.642857142857143,0.5,0.5,0.785714285714286,0.285714285714286,0.714285714285714,0.133333333333333,0.333333333333333,0.133333333333333,0.181818181818182,0.181818181818182,0.5,0.0909090909090909,0.136363636363636,0.136363636363636,0.227272727272727],"text":"field_cate_cd: Social Sciences","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(251,97,215,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(251,97,215,1)"}},"hoveron":"points","name":"Social Sciences","legendgroup":"Social Sciences","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.02352941176471,8.83921568627451],"tickmode":"array","ticktext":["4","6","8"],"tickvals":[4,6,8],"categoryorder":"array","categoryarray":["4","6","8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Attractive Peer Score","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Interest Proportion","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"c187594e11fe":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"c187594e11fe","visdat":{"c187594e11fe":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="co">#subplot(ggplotly(pl1, tooltip = c(&quot;cnt&quot;)), ggplotly(pl2, tooltip = c(&quot;field_cate_cd&quot;)), nrows=1)</span></a></code></pre></div>
<p>There is also no pattern among <code>proportion</code>, <code>peer_score</code>, and study <code>field</code>.</p>
<p>As far as we know, attractiveness is the only characteristic that have the strongest correlation with interest propotion. In conclusion, we found that people with low self esteem in their attractiveness gain more romantic interest after the event.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="interactive-component.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bojum/speeddating/edit/master/07-conclusion.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/bojum/speeddating/blob/master/07-conclusion.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
