<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Results | How to Get More Matches in Speed Dating</title>
  <meta name="description" content="Chapter 5 Results | How to Get More Matches in Speed Dating" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Results | How to Get More Matches in Speed Dating" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Results | How to Get More Matches in Speed Dating" />
  
  
  

<meta name="author" content="Yingyu Cao (yc3713), Bo Jumrustanasan (pj2356), Michael Qi (zq2175)" />


<meta name="date" content="2019-12-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="missing-values.html"/>
<link rel="next" href="interactive-component.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dating 101</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a><ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#experimental-design"><i class="fa fa-check"></i><b>2.1</b> Experimental Design</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#data-description"><i class="fa fa-check"></i><b>2.2</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a><ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#question-will-backrgound-and-common-interests-influence-the-match-which-feature-is-the-most-influential"><i class="fa fa-check"></i><b>5.1</b> Question: Will backrgound and common interests influence the match? Which feature is the most influential?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a><ul>
<li class="chapter" data-level="7.1" data-path="conclusion.html"><a href="conclusion.html#question-will-backrgound-and-common-interests-influence-the-match-which-feature-is-the-most-influential-1"><i class="fa fa-check"></i><b>7.1</b> Question: Will backrgound and common interests influence the match? Which feature is the most influential?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">How to Get More Matches in Speed Dating</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="results" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Results</h1>
<div id="question-will-backrgound-and-common-interests-influence-the-match-which-feature-is-the-most-influential" class="section level2">
<h2><span class="header-section-number">5.1</span> Question: Will backrgound and common interests influence the match? Which feature is the most influential?</h2>
<p>To answer this question, we have to look at background and common interests seperately. Background includes three features: <code>race</code>, <code>from</code>, and <code>field</code>. We can do so by comparing the chance of matching by conditioning on whether they are from the same <code>race</code>, same <code>from</code> (location), and same <code>field</code>.</p>
<p>Data Cleaning:</p>
<p>we would like to append 6 indicator columns that indicates whether this person and his/her partner share that feature in common (actually 5 because samerace is available in the original data).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">save</span>(speed_dating_q1, <span class="dt">file =</span> <span class="st">&quot;data/speed_dating_q1.Rdata&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># for mosaic plot </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co"># create a clean dataframe for each common feature</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">sameracedata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samerace, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">samerace =</span> <span class="kw">if_else</span>(samerace <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">samelocationdata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samelocation, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">samefielddata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samefield, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">samesportsdata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samesports, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">samereadingdata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samereading, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">samemoviesdata =<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(samemovies, match) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="kw">cat</span>(</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">  <span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb8-12" data-line-number="12">  <span class="st">&#39;&lt;script&gt;</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="st">    var sameracedata = &#39;</span>,<span class="kw">toJSON</span>(sameracedata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="st">    var samelocationdata = &#39;</span>,<span class="kw">toJSON</span>(samelocationdata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="st">    var samefielddata = &#39;</span>,<span class="kw">toJSON</span>(samefielddata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="st">    var samesportsdata = &#39;</span>,<span class="kw">toJSON</span>(samesportsdata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="st">    var samereadingdata = &#39;</span>,<span class="kw">toJSON</span>(samereadingdata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="st">    var samemoviesdata = &#39;</span>,<span class="kw">toJSON</span>(samemoviesdata),<span class="st">&#39;;</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="st">  &lt;/script&gt;&#39;</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20">  , <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb8-21" data-line-number="21">)</a></code></pre></div>
<script>
    var sameracedata = [{"samerace":"No","match":"No","Freq":3398},{"samerace":"No","match":"Yes","Freq":620},{"samerace":"Yes","match":"No","Freq":2164},{"samerace":"Yes","match":"Yes","Freq":476}];
    var samelocationdata = [{"samelocation":"No","match":"No","Freq":5516},{"samelocation":"No","match":"Yes","Freq":1082},{"samelocation":"Yes","match":"No","Freq":46},{"samelocation":"Yes","match":"Yes","Freq":14}];
    var samefielddata = [{"samefield":"No","match":"No","Freq":5460},{"samefield":"No","match":"Yes","Freq":1054},{"samefield":"Yes","match":"No","Freq":102},{"samefield":"Yes","match":"Yes","Freq":42}];
    var samesportsdata = [{"samesports":"No","match":"No","Freq":4012},{"samesports":"No","match":"Yes","Freq":746},{"samesports":"Yes","match":"No","Freq":1550},{"samesports":"Yes","match":"Yes","Freq":350}];
    var samereadingdata = [{"samereading":"No","match":"No","Freq":2408},{"samereading":"No","match":"Yes","Freq":424},{"samereading":"Yes","match":"No","Freq":3154},{"samereading":"Yes","match":"Yes","Freq":672}];
    var samemoviesdata = [{"samemovies":"No","match":"No","Freq":1570},{"samemovies":"No","match":"Yes","Freq":344},{"samemovies":"Yes","match":"No","Freq":3992},{"samemovies":"Yes","match":"Yes","Freq":752}];
  </script>
<script src="https://d3js.org/d3.v5.min.js"></script>
<svg width="910" height="550">
</svg>
<script>
  //initialize the svg
  var w = 800;
  var h = 500;
  var margin = {top: 25, right: 25, bottom: 25, left: 25};
  var innerWidth = w - margin.left - margin.right;
  var innerHeight = h - margin.top - margin.bottom;
  var dur = 500;
  
  var svg = d3.select("svg");
  svg.append("rect").attr("x", 0).attr("y", 0).attr("width", w).attr("height", h).attr("fill", "aliceblue");
  
  //initialize dataset
  var fill = "lightblue";
  var stroke = "#D0D3D4";
  var textfill = "#797D7F";
  
  var dataset = [{key: "race", value: sameracedata, f:"#2471A3", s:"#4B4C4D", tf: "#4B4C4D", axis: "Same Race", selected: "True", fw: "bold"}
                ,{key: "location", value: samelocationdata, f:fill, s:stroke, tf: textfill, axis: "from Same Location", selected: "False", fw: "normal"}
                ,{key: "field", value: samefielddata, f:fill, s:stroke, tf: textfill, axis: "Work in Same Field", selected: "False", fw: "normal"}
                ,{key: "sports", value: samesportsdata, f:fill, s:stroke, tf: textfill, axis: "Both love Sports", selected: "False", fw: "normal"}
                ,{key: "reading", value: samereadingdata, f:fill, s:stroke, tf: textfill, axis: "Both love Reading", selected: "False", fw: "normal"}
                ,{key: "movie", value: samemoviesdata, f:fill, s:stroke, tf: textfill, axis: "Both love Movies", selected: "False", fw: "normal"}];
  
  // use race feature as the initial plot
  var data = sameracedata;

  //manually transform to a mosaic plot
  function format(data){
    var offset = 50;
    var plotwidth = 350;
    var plotheight = 350;
    var bar2_x = (data[0].Freq+data[1].Freq)/d3.sum(data.map(d => d.Freq))*(plotwidth-5);
    var bar1_y = data[0].Freq/(data[0].Freq+data[1].Freq)*plotheight;
    var bar2_y = data[2].Freq/(data[2].Freq+data[3].Freq)*plotheight;
    return [{x: 2.5* offset, y: 1.5 * offset, w: bar2_x, h:bar1_y, f: "#D0D3D4", lx: bar2_x, t: "No", tx: 2.5 * offset+(bar2_x+5)/2, ty: 1.5 * offset -15},
            {x: 2.5* offset, y:bar1_y+1.5 * offset, w: bar2_x, h:plotheight-bar1_y, f: "#7B7D7D", t: "No", tx: 2.5 * offset-30, ty: bar1_y/2+1.5*offset},
            {x:bar2_x+5+2.5* offset, y:1.5 * offset, w: plotwidth-5-bar2_x, h: bar2_y, f: "#D0D3D4", t: "Yes", tx: 2.5 * offset+(bar2_x+5)+(plotwidth-(bar2_x+5))/2, ty: 1.5 * offset - 15},
            {x:bar2_x+5+2.5* offset, y: bar2_y+1.5 * offset, w:plotwidth-5-bar2_x, h: plotheight - bar2_y, f:"#7B7D7D", t: "Yes", tx:  2.5 * offset-30, ty: (plotheight - bar1_y)/2+bar1_y+1.5 * offset}];
  }
  
  //append the plot to a new group g
  var bars = svg.append("g")
                .attr("id", "plot")
                .attr("transform", `translate (${margin.left}, ${margin.top})`)
              .selectAll("rect")
                .data(format(data));
  
  // plot the initial plot
  bars.enter().append("rect")
      .attr("class", "bar")
      .attr("x", d => d.x)
      .attr("y", d => d.y)  
      .attr("width", d => d.w)
      .attr("height", d => d.h)
      .attr("fill",d => d.f)
      .attr("stroke", "#7B7D7D")
      .attr("stroke-width", "1");
      
  //add labels for axis
  svg.append("text")
      .attr("x", "50")
      .attr("y", "250")
      .attr("font-size","20")
      .attr("text-anchor","middle")
      .attr("font-family","helvetica")
      .attr("fill", "#313132")
      .attr("font-weight","bold")
      .text("Match");
                      
  var xlabel = svg.append("g")
                  .attr("id", "axis")
                  .attr("transform",`translate (${margin.left}, ${margin.top})`)
                .selectAll("text")
                  .data([dataset[0]], d=>d.key).enter()
                  .append("text")
                  .attr("x", "300")
                  .attr("y", "20")
                  .attr("font-size","20")
                  .attr("text-anchor","middle")
                  .attr("font-family","helvetica")
                  .attr("fill", "#313132")
                  .attr("font-weight","bold")
                  .text(d =>d.axis);        
  
  
  // add radio buttons
  var buttons1 = svg.append("g")
                    .attr("id", "buttons1")
                    .attr("class", "radio")
                    .attr("transform",  `translate (${margin.left}, ${margin.top})`)
                  .selectAll("circle")
                    .data(dataset, d=>d.key).enter().append("circle")
                    .attr("cx", "580")
                    .attr("cy", (d,i) => i*50+125)
                    .attr("r", "13")
                    .attr("fill", "aliceblue")
                    .attr("stroke", d=>d.s)
                    .attr("stroke-width", "3")
                    
  var buttons2 = svg.append("g")
                    .attr("id", "buttons2")
                    .attr("class", "radio")
                    .attr("transform",  `translate (${margin.left}, ${margin.top})`)
                  .selectAll("circle")
                    .data(dataset, d=>d.key).enter().append("circle")
                    .attr("cx", "580")
                    .attr("cy", (d,i) => i*50+125)
                    .attr("r", "6")
                    .attr("fill", d => d.f)
                    
  // add "Yes" and "No" text labels
  var labels = svg.select("g#plot").selectAll("text").data(format(data));
  
  labels.enter().append("text")
      .attr("id", "label")
      .attr("x", d=>d.tx)
      .attr("y", d=>d.ty)
      .attr("font-size","18")
      .attr("text-anchor","middle")
      .attr("font-family","helvetica")
      .attr("fill", "#313132")
      .text(d =>d.t); 
                
  //append text next to buttons
  var texts = svg.append("g")
                .attr("id", "texts")
                .attr("class", "radio")
                .attr("transform", `translate (${margin.left}, ${margin.top})`)
              .selectAll("text")
                .data(dataset, d=>d.key).enter().append("text")
                .attr("x", "610")
                .attr("y", (d, i) => i*50+130)
                .attr("fill", d=>d.tf)
                .attr("font-size","20")
                .attr("font-family", "helvetica")
                .attr("font-weight", d=>d.fw)
                .text(d=>d.key);
                    
  //switch event listeners if a button is clicked
  d3.selectAll("g.radio").selectAll("circle").on("click", function(){
    //update the chart
    update(format(d3.select(this).datum().value));
    //change the color of the radio buttons
    dataset.map(d => d.f = fill);
    dataset.map(d => d.s = stroke);
    dataset.map(d => d.tf = textfill);
    dataset.map(d => d.selected = "False");
    d3.select(this).datum().f = "#2471A3";
    d3.select(this).datum().s = "#4B4C4D";
    d3.select(this).datum().tf = "#4B4C4D";
    d3.select(this).datum().selected = "True";
    updatebutton(dataset);
    //change axis label
    xlabel.data([d3.select(this).datum()]).text(d=>d.axis);
  });
      
  // update method (using general update pattern)
  function update(data){
    var bars = svg.select("#plot").selectAll("rect").data(data);
    bars.transition().duration(dur)
        .ease(d3.easeLinear)
        .attr("x", d => d.x)
        .attr("y", d => d.y)  
        .attr("width", d => d.w)
        .attr("height", d => d.h);
    var labels = svg.selectAll("text#label").data(data);
    labels.transition().duration(dur)
        .ease(d3.easeLinear)
        .attr("x", d => d.tx)
        .attr("y", d => d.ty) 
  }
  
  // update method(for radio buttons)
  function updatebutton(dataset){
    buttons1.data(dataset).attr("stroke", d => d.s);
    buttons2.data(dataset).attr("fill", d=> d.f);
    texts.data(dataset).attr("fill", d=>d.tf).attr("font-weight", d=>d.fw);
  }
  
  d3.selectAll("g.radio").selectAll("circle").on("mouseover", handleMouseOver).on("mouseout", handleMouseOut);
  
  function handleMouseOver(){
    if(d3.select(this).datum().selected == "False"){
      d3.select(this).datum().f = "#4a9bd4";
      d3.select(this).datum().s = "#969696";
      d3.select(this).datum().tf = "#969696";
      d3.select(this).datum().fw = "bold";
      updatebutton(dataset);
    }
  }
  
  function handleMouseOut(){
    if(d3.select(this).datum().selected == "False"){
      d3.select(this).datum().f = fill;
      d3.select(this).datum().s = stroke;
      d3.select(this).datum().tf = textfill;
      d3.select(this).datum().fw = "normal";
      updatebutton(dataset);
    }
  }
</script>
<p>We then look at all the available features that could be of common interest in the dataset, and see if any of those features heavily impacts the chances of getting matched.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">calc_diff &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  tmp &lt;-<span class="st"> </span>speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by_</span>(x, <span class="st">&#39;match&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">match =</span> <span class="kw">if_else</span>(match <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  no_rate &lt;-<span class="st"> </span>tmp[<span class="dv">2</span>,<span class="dv">3</span>]<span class="op">/</span>(tmp[<span class="dv">2</span>,<span class="dv">3</span>]<span class="op">+</span>tmp[<span class="dv">1</span>,<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  yes_rate &lt;-<span class="st"> </span>tmp[<span class="dv">4</span>,<span class="dv">3</span>]<span class="op">/</span>(tmp[<span class="dv">3</span>,<span class="dv">3</span>]<span class="op">+</span>tmp[<span class="dv">4</span>,<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="kw">return</span>(yes_rate <span class="op">-</span><span class="st"> </span>no_rate)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">cd_df &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind,<span class="kw">lapply</span>(<span class="kw">paste0</span>(<span class="st">&#39;same&#39;</span>,<span class="kw">colnames</span>(speed_dating <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sports<span class="op">:</span>yoga))),calc_diff))<span class="op">*</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">cd_df &lt;-<span class="st"> </span><span class="kw">cbind</span>(cd_df, names)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9"></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="kw">ggplot</span>(cd_df,<span class="kw">aes</span>(<span class="dt">x=</span>Freq,<span class="dt">y=</span><span class="kw">fct_reorder</span>(names,Freq)))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">color=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Percent (%)&quot;</span>)<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;Differences in Chance of Matching&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="missing-values.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interactive-component.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bojum/speeddating/edit/master/05-results.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/bojum/speeddating/blob/master/05-results.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
